

============================== 2025-04-06 12:14:29.102595 | 15ba7da4-afd3-47dc-a3c2-55757a4d87ee ==============================
[0m12:14:29.102595 [info ] [MainThread]: Running with dbt=1.4.9
[0m12:14:29.106178 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['crime_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:14:29.110245 [debug] [MainThread]: Tracking: tracking
[0m12:14:29.117465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f885ce720d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f885ce722b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f885ce72ca0>]}
[0m12:14:29.153383 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m12:14:29.162752 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:14:29.164384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '15ba7da4-afd3-47dc-a3c2-55757a4d87ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f885cf003d0>]}
[0m12:14:30.860696 [debug] [MainThread]: 1699: static parser successfully parsed mart/crime_fact.sql
[0m12:14:30.888636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f887ea35c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f887ea272e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f887ea85130>]}
[0m12:14:30.889934 [debug] [MainThread]: Flushing usage events
[0m12:14:31.081095 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.boston_crime_project.crime_fact' (models/mart/crime_fact.sql) depends on a node named 'crime_incidents_stg' which was not found


============================== 2025-04-06 12:23:28.765757 | 71b0b386-0e03-43be-aa59-2cd3ab0b41c1 ==============================
[0m12:23:28.765757 [info ] [MainThread]: Running with dbt=1.4.9
[0m12:23:28.769122 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['crime_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:23:28.770504 [debug] [MainThread]: Tracking: tracking
[0m12:23:28.777678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850ac98ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850ac98d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850ac98d60>]}
[0m12:23:28.796776 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m12:23:28.815559 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:23:28.818374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '71b0b386-0e03-43be-aa59-2cd3ab0b41c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850acb20d0>]}
[0m12:23:29.913479 [debug] [MainThread]: 1699: static parser successfully parsed mart/crime_fact.sql
[0m12:23:30.075343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71b0b386-0e03-43be-aa59-2cd3ab0b41c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85308f7d90>]}
[0m12:23:30.112331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71b0b386-0e03-43be-aa59-2cd3ab0b41c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8531996460>]}
[0m12:23:30.118092 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:23:30.122870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71b0b386-0e03-43be-aa59-2cd3ab0b41c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f850acb28b0>]}
[0m12:23:30.130686 [info ] [MainThread]: 
[0m12:23:30.142309 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:23:30.150896 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m12:23:30.155708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:30.166421 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/keys/creds.json''
[0m12:23:30.176762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:30.180445 [debug] [MainThread]: Connection 'list_galvanic-flame-447801-n5' was properly closed.
[0m12:23:30.183363 [info ] [MainThread]: 
[0m12:23:30.187381 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m12:23:30.190471 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/keys/creds.json'
[0m12:23:30.193603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85308b3a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85308b38e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85308b31f0>]}
[0m12:23:30.196120 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 12:39:38.650253 | 01d3355d-01fd-42dd-b14a-8cc8dfc12a0b ==============================
[0m12:39:38.650253 [info ] [MainThread]: Running with dbt=1.4.9
[0m12:39:38.653588 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['crime_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:39:38.655114 [debug] [MainThread]: Tracking: tracking
[0m12:39:38.663219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb637bc1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb637bc1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb637bc1d60>]}
[0m12:39:38.688745 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m12:39:38.744551 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:39:38.746626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01d3355d-01fd-42dd-b14a-8cc8dfc12a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb637bdd820>]}
[0m12:39:40.404484 [debug] [MainThread]: 1699: static parser successfully parsed mart/crime_fact.sql
[0m12:39:40.586920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01d3355d-01fd-42dd-b14a-8cc8dfc12a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65e939580>]}
[0m12:39:40.619796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01d3355d-01fd-42dd-b14a-8cc8dfc12a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65d7f3940>]}
[0m12:39:40.625044 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:39:40.631318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d3355d-01fd-42dd-b14a-8cc8dfc12a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65d83ccd0>]}
[0m12:39:40.641572 [info ] [MainThread]: 
[0m12:39:40.657290 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:39:40.670558 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m12:39:40.676643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:41.499887 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_galvanic-flame-447801-n5_boston_crime_boston_crime'
[0m12:39:41.506561 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_galvanic-flame-447801-n5_boston_crime_boston_crime'
[0m12:39:41.511557 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='galvanic-flame-447801-n5', schema='boston_crime_boston_crime', identifier=None)"
[0m12:39:41.566426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:41.701974 [debug] [ThreadPool]: On create_galvanic-flame-447801-n5_boston_crime_boston_crime: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "connection_name": "create_galvanic-flame-447801-n5_boston_crime_boston_crime"} */
create schema if not exists `galvanic-flame-447801-n5`.`boston_crime_boston_crime`
  
[0m12:39:43.347193 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:US:fc61cea6-3023-43c5-9a4c-1e9df1f55e05&page=queryresults
[0m12:39:43.363145 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime_boston_crime'
[0m12:39:43.367968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:43.950259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d3355d-01fd-42dd-b14a-8cc8dfc12a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65d7f35e0>]}
[0m12:39:43.952190 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:43.953476 [info ] [MainThread]: 
[0m12:39:43.974021 [debug] [Thread-1  ]: Began running node model.boston_crime_project.crime_fact
[0m12:39:43.976199 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime_boston_crime.crime_fact ........ [RUN]
[0m12:39:43.978410 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.crime_fact'
[0m12:39:43.979542 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.crime_fact
[0m12:39:43.984656 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.crime_fact"
[0m12:39:44.003574 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.crime_fact (compile): 2025-04-06 12:39:43.980717 => 2025-04-06 12:39:44.003430
[0m12:39:44.004675 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.crime_fact
[0m12:39:44.095169 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.crime_fact"
[0m12:39:44.192960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:44.352738 [debug] [Thread-1  ]: On model.boston_crime_project.crime_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.crime_fact"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime_boston_crime`.`crime_fact`
    partition by range_bucket(
            year,
            generate_array(, , )
        )
    
    OPTIONS()
    as (
      

WITH casted AS (
    SELECT
        CAST(INCIDENT_NUMBER AS STRING) AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        OFFENSE_CODE_GROUP AS offense_code_group,
        OFFENSE_DESCRIPTION AS offense_description,
        DISTRICT AS district,
        REPORTING_AREA AS reporting_area,
        SHOOTING AS shooting,
        -- if OCCRURRED_ON_DATE is actually a datetime string, parse to timestamp
        CAST(OCCURRED_ON_DATE AS TIMESTAMP) AS occurred_on_date,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        DAY_OF_WEEK AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        UCR_PART AS ucr_part,
        STREET AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
)

SELECT * FROM casted
    );
  
[0m12:39:44.877607 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "," at [9:28]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got "," at [9:28]')
[0m12:39:45.697450 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:US:5850eb1c-c573-4b4d-8659-2184ed7b9e68&page=queryresults
[0m12:39:45.703922 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.crime_fact (execute): 2025-04-06 12:39:44.005514 => 2025-04-06 12:39:45.703617
[0m12:39:45.736731 [debug] [Thread-1  ]: Database Error in model crime_fact (models/mart/crime_fact.sql)
  Syntax error: Expected ")" but got "," at [9:28]
  compiled Code at target/run/boston_crime_project/models/mart/crime_fact.sql
[0m12:39:45.742616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d3355d-01fd-42dd-b14a-8cc8dfc12a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65d741730>]}
[0m12:39:45.748937 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model boston_crime_boston_crime.crime_fact  [[31mERROR[0m in 1.76s]
[0m12:39:45.761212 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.crime_fact
[0m12:39:45.773442 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:39:45.780077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:45.784726 [debug] [MainThread]: Connection 'model.boston_crime_project.crime_fact' was properly closed.
[0m12:39:45.789132 [info ] [MainThread]: 
[0m12:39:45.794612 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m12:39:45.800653 [debug] [MainThread]: Command end result
[0m12:39:45.891907 [info ] [MainThread]: 
[0m12:39:45.900057 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:39:45.907321 [info ] [MainThread]: 
[0m12:39:45.914493 [error] [MainThread]: [33mDatabase Error in model crime_fact (models/mart/crime_fact.sql)[0m
[0m12:39:45.920005 [error] [MainThread]:   Syntax error: Expected ")" but got "," at [9:28]
[0m12:39:45.925774 [error] [MainThread]:   compiled Code at target/run/boston_crime_project/models/mart/crime_fact.sql
[0m12:39:45.932203 [info ] [MainThread]: 
[0m12:39:45.938808 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:39:45.946450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65e9a69a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65e883670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65d7f3a00>]}
[0m12:39:45.953127 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 12:42:42.858718 | d85b70d9-0e83-4f64-83e2-2d8a4b8aa8fc ==============================
[0m12:42:42.858718 [info ] [MainThread]: Running with dbt=1.4.9
[0m12:42:42.862061 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['crime_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:42:42.863532 [debug] [MainThread]: Tracking: tracking
[0m12:42:42.871557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808d77efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808d77ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808d77ee80>]}
[0m12:42:42.900799 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m12:42:43.251567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:43.253153 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/crime_fact.sql
[0m12:42:43.286790 [debug] [MainThread]: 1699: static parser successfully parsed mart/crime_fact.sql
[0m12:42:43.322311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd85b70d9-0e83-4f64-83e2-2d8a4b8aa8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80af2ed0d0>]}
[0m12:42:43.343753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd85b70d9-0e83-4f64-83e2-2d8a4b8aa8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b03a2fa0>]}
[0m12:42:43.344996 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:42:43.346235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd85b70d9-0e83-4f64-83e2-2d8a4b8aa8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b040a5b0>]}
[0m12:42:43.348445 [info ] [MainThread]: 
[0m12:42:43.351253 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:42:43.353302 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m12:42:43.354362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:43.875385 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime_boston_crime'
[0m12:42:43.876976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:44.389676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd85b70d9-0e83-4f64-83e2-2d8a4b8aa8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80af2edac0>]}
[0m12:42:44.396493 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:44.401776 [info ] [MainThread]: 
[0m12:42:44.474130 [debug] [Thread-1  ]: Began running node model.boston_crime_project.crime_fact
[0m12:42:44.479309 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime_boston_crime.crime_fact ........ [RUN]
[0m12:42:44.486678 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.crime_fact'
[0m12:42:44.490904 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.crime_fact
[0m12:42:44.510288 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.crime_fact"
[0m12:42:44.559848 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.crime_fact (compile): 2025-04-06 12:42:44.495154 => 2025-04-06 12:42:44.559440
[0m12:42:44.564595 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.crime_fact
[0m12:42:44.850384 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.crime_fact"
[0m12:42:44.896500 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:42:45.044012 [debug] [Thread-1  ]: On model.boston_crime_project.crime_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.crime_fact"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime_boston_crime`.`crime_fact`
    partition by range_bucket(
            year,
            generate_array(, , )
        )
    
    OPTIONS()
    as (
      

WITH casted AS (
    SELECT
        CAST(INCIDENT_NUMBER AS STRING) AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        OFFENSE_CODE_GROUP AS offense_code_group,
        OFFENSE_DESCRIPTION AS offense_description,
        DISTRICT AS district,
        REPORTING_AREA AS reporting_area,
        SHOOTING AS shooting,
        CAST(OCCURRED_ON_DATE AS TIMESTAMP) AS occurred_on_date,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        DAY_OF_WEEK AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        UCR_PART AS ucr_part,
        STREET AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
)

SELECT * FROM casted
    );
  
[0m12:42:45.416648 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "," at [9:28]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got "," at [9:28]')
[0m12:42:45.775259 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:US:e452daee-f0d8-43d7-ae24-d9ad2e715033&page=queryresults
[0m12:42:45.777542 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.crime_fact (execute): 2025-04-06 12:42:44.568661 => 2025-04-06 12:42:45.777424
[0m12:42:45.788473 [debug] [Thread-1  ]: Database Error in model crime_fact (models/mart/crime_fact.sql)
  Syntax error: Expected ")" but got "," at [9:28]
  compiled Code at target/run/boston_crime_project/models/mart/crime_fact.sql
[0m12:42:45.794615 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85b70d9-0e83-4f64-83e2-2d8a4b8aa8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80af1d0fd0>]}
[0m12:42:45.800927 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model boston_crime_boston_crime.crime_fact  [[31mERROR[0m in 1.31s]
[0m12:42:45.816006 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.crime_fact
[0m12:42:45.829971 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:42:45.836688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:45.841410 [debug] [MainThread]: Connection 'model.boston_crime_project.crime_fact' was properly closed.
[0m12:42:45.846066 [info ] [MainThread]: 
[0m12:42:45.851081 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m12:42:45.856876 [debug] [MainThread]: Command end result
[0m12:42:45.942531 [info ] [MainThread]: 
[0m12:42:45.947776 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:42:45.952865 [info ] [MainThread]: 
[0m12:42:45.958777 [error] [MainThread]: [33mDatabase Error in model crime_fact (models/mart/crime_fact.sql)[0m
[0m12:42:45.963905 [error] [MainThread]:   Syntax error: Expected ")" but got "," at [9:28]
[0m12:42:45.969162 [error] [MainThread]:   compiled Code at target/run/boston_crime_project/models/mart/crime_fact.sql
[0m12:42:45.974974 [info ] [MainThread]: 
[0m12:42:45.980420 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:42:45.985807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808d715790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80af1ecdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80af1ec640>]}
[0m12:42:45.991031 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 12:47:37.973259 | 9df95b92-27b1-4ab1-a781-a785aaa473ba ==============================
[0m12:47:37.973259 [info ] [MainThread]: Running with dbt=1.4.9
[0m12:47:37.977244 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['crime_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:47:37.978924 [debug] [MainThread]: Tracking: tracking
[0m12:47:37.989771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bb9d13fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bb9d13b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bb9d13e80>]}
[0m12:47:38.023938 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m12:47:38.271749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:47:38.274242 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/crime_fact.sql
[0m12:47:38.329964 [debug] [MainThread]: 1699: static parser successfully parsed mart/crime_fact.sql
[0m12:47:38.402263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9df95b92-27b1-4ab1-a781-a785aaa473ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bdbac10d0>]}
[0m12:47:38.422534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9df95b92-27b1-4ab1-a781-a785aaa473ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bdc936ee0>]}
[0m12:47:38.423881 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:47:38.425550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9df95b92-27b1-4ab1-a781-a785aaa473ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bdc99f520>]}
[0m12:47:38.432328 [info ] [MainThread]: 
[0m12:47:38.443838 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:47:38.453413 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m12:47:38.459015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:39.109990 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime_boston_crime'
[0m12:47:39.114681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:39.612202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9df95b92-27b1-4ab1-a781-a785aaa473ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bb9cf1910>]}
[0m12:47:39.615177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:47:39.617200 [info ] [MainThread]: 
[0m12:47:39.642195 [debug] [Thread-1  ]: Began running node model.boston_crime_project.crime_fact
[0m12:47:39.644370 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime_boston_crime.crime_fact ........ [RUN]
[0m12:47:39.646823 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.crime_fact'
[0m12:47:39.648456 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.crime_fact
[0m12:47:39.654340 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.crime_fact"
[0m12:47:39.666336 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.crime_fact (compile): 2025-04-06 12:47:39.649879 => 2025-04-06 12:47:39.666150
[0m12:47:39.667616 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.crime_fact
[0m12:47:39.782563 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.crime_fact"
[0m12:47:39.809209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:47:39.869972 [debug] [Thread-1  ]: On model.boston_crime_project.crime_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.crime_fact"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime_boston_crime`.`crime_fact`
    
    cluster by year, month
    OPTIONS()
    as (
      

WITH casted AS (
    SELECT
        CAST(INCIDENT_NUMBER AS STRING) AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        OFFENSE_CODE_GROUP AS offense_code_group,
        OFFENSE_DESCRIPTION AS offense_description,
        DISTRICT AS district,
        REPORTING_AREA AS reporting_area,
        SHOOTING AS shooting,
        CAST(OCCURRED_ON_DATE AS TIMESTAMP) AS occurred_on_date,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        DAY_OF_WEEK AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        UCR_PART AS ucr_part,
        STREET AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
)

SELECT * FROM casted
    );
  
[0m12:47:40.328211 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.crime_fact"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime_boston_crime`.`crime_fact`
    
    cluster by year, month
    OPTIONS()
    as (
      

WITH casted AS (
    SELECT
        CAST(INCIDENT_NUMBER AS STRING) AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        OFFENSE_CODE_GROUP AS offense_code_group,
        OFFENSE_DESCRIPTION AS offense_description,
        DISTRICT AS district,
        REPORTING_AREA AS reporting_area,
        SHOOTING AS shooting,
        CAST(OCCURRED_ON_DATE AS TIMESTAMP) AS occurred_on_date,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        DAY_OF_WEEK AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        UCR_PART AS ucr_part,
        STREET AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
)

SELECT * FROM casted
    );
  
[0m12:47:40.331291 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Dataset galvanic-flame-447801-n5:boston_crime_boston_crime was not found in location us-east1; reason: notFound, message: Not found: Dataset galvanic-flame-447801-n5:boston_crime_boston_crime was not found in location us-east1

Location: us-east1
Job ID: 657ce11b-28c7-486b-9232-1fcbb409bc25

[0m12:47:40.333825 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.crime_fact (execute): 2025-04-06 12:47:39.668845 => 2025-04-06 12:47:40.333690
[0m12:47:40.342239 [debug] [Thread-1  ]: Runtime Error in model crime_fact (models/mart/crime_fact.sql)
  404 Not found: Dataset galvanic-flame-447801-n5:boston_crime_boston_crime was not found in location us-east1; reason: notFound, message: Not found: Dataset galvanic-flame-447801-n5:boston_crime_boston_crime was not found in location us-east1
  
  Location: us-east1
  Job ID: 657ce11b-28c7-486b-9232-1fcbb409bc25
  
[0m12:47:40.345053 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df95b92-27b1-4ab1-a781-a785aaa473ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd97b5e50>]}
[0m12:47:40.347660 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model boston_crime_boston_crime.crime_fact  [[31mERROR[0m in 0.70s]
[0m12:47:40.353310 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.crime_fact
[0m12:47:40.359058 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:47:40.362100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:40.364091 [debug] [MainThread]: Connection 'model.boston_crime_project.crime_fact' was properly closed.
[0m12:47:40.365908 [info ] [MainThread]: 
[0m12:47:40.368745 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m12:47:40.372731 [debug] [MainThread]: Command end result
[0m12:47:40.416737 [info ] [MainThread]: 
[0m12:47:40.422912 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:47:40.428119 [info ] [MainThread]: 
[0m12:47:40.434204 [error] [MainThread]: [33mRuntime Error in model crime_fact (models/mart/crime_fact.sql)[0m
[0m12:47:40.440976 [error] [MainThread]:   404 Not found: Dataset galvanic-flame-447801-n5:boston_crime_boston_crime was not found in location us-east1; reason: notFound, message: Not found: Dataset galvanic-flame-447801-n5:boston_crime_boston_crime was not found in location us-east1
[0m12:47:40.447050 [error] [MainThread]:   
[0m12:47:40.453173 [error] [MainThread]:   Location: us-east1
[0m12:47:40.458501 [error] [MainThread]:   Job ID: 657ce11b-28c7-486b-9232-1fcbb409bc25
[0m12:47:40.463709 [error] [MainThread]:   
[0m12:47:40.470423 [info ] [MainThread]: 
[0m12:47:40.476001 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:47:40.481762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bdc99f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bdc936be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bdc936dc0>]}
[0m12:47:40.486526 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 12:50:35.062681 | fef1d513-704e-4e96-b200-ee5354519043 ==============================
[0m12:50:35.062681 [info ] [MainThread]: Running with dbt=1.4.9
[0m12:50:35.068034 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['crime_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:50:35.070239 [debug] [MainThread]: Tracking: tracking
[0m12:50:35.082651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ed30a4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ed30a4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ed30a4eb0>]}
[0m12:50:35.132087 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m12:50:35.169381 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:50:35.171121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fef1d513-704e-4e96-b200-ee5354519043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ed30ba5b0>]}
[0m12:50:36.389692 [debug] [MainThread]: 1699: static parser successfully parsed mart/crime_fact.sql
[0m12:50:36.502326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fef1d513-704e-4e96-b200-ee5354519043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef9e047f0>]}
[0m12:50:36.524876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fef1d513-704e-4e96-b200-ee5354519043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef8ed12e0>]}
[0m12:50:36.526206 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:50:36.527397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fef1d513-704e-4e96-b200-ee5354519043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef8f04dc0>]}
[0m12:50:36.529671 [info ] [MainThread]: 
[0m12:50:36.532780 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:50:36.535284 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m12:50:36.536615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:37.038815 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m12:50:37.043830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:37.598755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fef1d513-704e-4e96-b200-ee5354519043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef8ec82b0>]}
[0m12:50:37.605566 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:50:37.610598 [info ] [MainThread]: 
[0m12:50:37.682156 [debug] [Thread-1  ]: Began running node model.boston_crime_project.crime_fact
[0m12:50:37.688529 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.crime_fact ..................... [RUN]
[0m12:50:37.696801 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.crime_fact'
[0m12:50:37.701517 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.crime_fact
[0m12:50:37.723663 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.crime_fact"
[0m12:50:37.769615 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.crime_fact (compile): 2025-04-06 12:50:37.705654 => 2025-04-06 12:50:37.769206
[0m12:50:37.774269 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.crime_fact
[0m12:50:38.130769 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.crime_fact"
[0m12:50:38.162901 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:50:38.246291 [debug] [Thread-1  ]: On model.boston_crime_project.crime_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.crime_fact"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`crime_fact`
    
    cluster by year, month
    OPTIONS()
    as (
      

WITH casted AS (
    SELECT
        CAST(INCIDENT_NUMBER AS STRING) AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        OFFENSE_CODE_GROUP AS offense_code_group,
        OFFENSE_DESCRIPTION AS offense_description,
        DISTRICT AS district,
        REPORTING_AREA AS reporting_area,
        SHOOTING AS shooting,
        CAST(OCCURRED_ON_DATE AS TIMESTAMP) AS occurred_on_date,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        DAY_OF_WEEK AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        UCR_PART AS ucr_part,
        STREET AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
)

SELECT * FROM casted
    );
  
[0m12:50:45.678531 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:2dd30b29-9b34-44bf-8f5d-39325f7f2ad4&page=queryresults
[0m12:50:45.779426 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.crime_fact (execute): 2025-04-06 12:50:37.778595 => 2025-04-06 12:50:45.779251
[0m12:50:45.784517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fef1d513-704e-4e96-b200-ee5354519043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef6c2ad60>]}
[0m12:50:45.788152 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.crime_fact ................ [[32mCREATE TABLE (832.4k rows, 121.8 MB processed)[0m in 8.09s]
[0m12:50:45.795415 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.crime_fact
[0m12:50:45.801880 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:50:45.805263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:45.807748 [debug] [MainThread]: Connection 'model.boston_crime_project.crime_fact' was properly closed.
[0m12:50:45.810180 [info ] [MainThread]: 
[0m12:50:45.813037 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.28 seconds (9.28s).
[0m12:50:45.816122 [debug] [MainThread]: Command end result
[0m12:50:45.858074 [info ] [MainThread]: 
[0m12:50:45.861774 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:45.865828 [info ] [MainThread]: 
[0m12:50:45.868834 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:50:45.871832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ed30ba790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef9e6a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef9e6a7c0>]}
[0m12:50:45.874462 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 18:28:39.391517 | ca50a64b-34e4-447f-9151-61f06373f34d ==============================
[0m18:28:39.391517 [info ] [MainThread]: Running with dbt=1.4.9
[0m18:28:39.394312 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['crime_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:28:39.395535 [debug] [MainThread]: Tracking: tracking
[0m18:28:39.401858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf445998e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf44599310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf44599400>]}
[0m18:28:39.426766 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m18:28:39.553749 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m18:28:39.554915 [debug] [MainThread]: Partial parsing: added file: boston_crime_project://models/mart/incident_fact.sql
[0m18:28:39.555833 [debug] [MainThread]: Partial parsing: deleted file: boston_crime_project://models/mart/crime_fact.sql
[0m18:28:39.582456 [debug] [MainThread]: 1699: static parser successfully parsed mart/incident_fact.sql
[0m18:28:39.610672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca50a64b-34e4-447f-9151-61f06373f34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf663600d0>]}
[0m18:28:39.626108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca50a64b-34e4-447f-9151-61f06373f34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf671b64c0>]}
[0m18:28:39.627084 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:28:39.628158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca50a64b-34e4-447f-9151-61f06373f34d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf44600d00>]}
[0m18:28:39.629433 [warn ] [MainThread]: The selection criterion 'crime_fact' does not match any nodes
[0m18:28:39.630990 [info ] [MainThread]: 
[0m18:28:39.632128 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:28:39.633294 [debug] [MainThread]: Command end result
[0m18:28:39.646472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf671b6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf671f5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf671f5040>]}
[0m18:28:39.647451 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 18:30:08.435551 | b2e605f8-f2a7-4e59-8bdf-81157ace8bd8 ==============================
[0m18:30:08.435551 [info ] [MainThread]: Running with dbt=1.4.9
[0m18:30:08.437764 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['crime_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:30:08.438690 [debug] [MainThread]: Tracking: tracking
[0m18:30:08.446294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f338d2bf880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f338d2bfe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f338d2bfe80>]}
[0m18:30:08.470283 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m18:30:08.549835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:30:08.550991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:30:08.559584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2e605f8-f2a7-4e59-8bdf-81157ace8bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33aff1c940>]}
[0m18:30:08.575282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2e605f8-f2a7-4e59-8bdf-81157ace8bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33afff2c10>]}
[0m18:30:08.576512 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:30:08.577749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2e605f8-f2a7-4e59-8bdf-81157ace8bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33afff2ca0>]}
[0m18:30:08.579515 [warn ] [MainThread]: The selection criterion 'crime_fact' does not match any nodes
[0m18:30:08.581676 [info ] [MainThread]: 
[0m18:30:08.583061 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:30:08.584637 [debug] [MainThread]: Command end result
[0m18:30:08.601731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33aff67df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33aff67eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33aff67d60>]}
[0m18:30:08.602879 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 18:37:28.854873 | 886de3ac-73d3-4274-a0a7-11754d5b4cd8 ==============================
[0m18:37:28.854873 [info ] [MainThread]: Running with dbt=1.4.9
[0m18:37:28.857573 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:37:28.858991 [debug] [MainThread]: Tracking: tracking
[0m18:37:28.864586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe49426afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe49426ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe49426aeb0>]}
[0m18:37:28.885688 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m18:37:28.963473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:37:28.964544 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:37:28.972065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '886de3ac-73d3-4274-a0a7-11754d5b4cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b6ec50d0>]}
[0m18:37:28.989861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '886de3ac-73d3-4274-a0a7-11754d5b4cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b6f95bb0>]}
[0m18:37:28.990908 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:37:28.991988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '886de3ac-73d3-4274-a0a7-11754d5b4cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b6f95c40>]}
[0m18:37:28.993671 [info ] [MainThread]: 
[0m18:37:28.996382 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:37:28.998353 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m18:37:28.999544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:29.422059 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m18:37:29.423549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:29.776790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '886de3ac-73d3-4274-a0a7-11754d5b4cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b6ec53a0>]}
[0m18:37:29.778601 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:37:29.780035 [info ] [MainThread]: 
[0m18:37:29.803361 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m18:37:29.804911 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m18:37:29.806803 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m18:37:29.808011 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m18:37:29.812098 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m18:37:29.819559 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 18:37:29.808976 => 2025-04-06 18:37:29.819462
[0m18:37:29.820472 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m18:37:29.894955 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m18:37:29.901618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:29.939483 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact`
    
    cluster by year, month
    OPTIONS()
    as (
      

WITH casted AS (
    SELECT
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        DATE(
          SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', TRIM(OCCURRED_ON_DATE))
        ) AS occurred_on_date,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
)

SELECT * FROM casted
    );
  
[0m18:37:37.633691 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:76806e7d-9cf5-4e80-839c-ff0e134cffbd&page=queryresults
[0m18:37:37.656687 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 18:37:29.821208 => 2025-04-06 18:37:37.656623
[0m18:37:37.658417 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '886de3ac-73d3-4274-a0a7-11754d5b4cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b6e35b50>]}
[0m18:37:37.659763 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.incident_fact ............. [[32mCREATE TABLE (832.4k rows, 121.8 MB processed)[0m in 7.85s]
[0m18:37:37.662030 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m18:37:37.664401 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:37:37.665472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:37.666156 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m18:37:37.666964 [info ] [MainThread]: 
[0m18:37:37.667888 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.67 seconds (8.67s).
[0m18:37:37.668952 [debug] [MainThread]: Command end result
[0m18:37:37.681739 [info ] [MainThread]: 
[0m18:37:37.683328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:37:37.684578 [info ] [MainThread]: 
[0m18:37:37.686359 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:37:37.688108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b6e0f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4942c6ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b6dd6f70>]}
[0m18:37:37.689316 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 18:43:15.863835 | 2be04dcf-9ec3-4369-ae32-823964a5b935 ==============================
[0m18:43:15.863835 [info ] [MainThread]: Running with dbt=1.4.9
[0m18:43:15.866506 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:43:15.867931 [debug] [MainThread]: Tracking: tracking
[0m18:43:15.874864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5968383c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5968383e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5968383e50>]}
[0m18:43:15.899193 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m18:43:16.009618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:43:16.010944 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/incident_fact.sql
[0m18:43:16.038694 [debug] [MainThread]: 1699: static parser successfully parsed mart/incident_fact.sql
[0m18:43:16.069321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2be04dcf-9ec3-4369-ae32-823964a5b935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5989fae0d0>]}
[0m18:43:16.084361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2be04dcf-9ec3-4369-ae32-823964a5b935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598b026ee0>]}
[0m18:43:16.085593 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:43:16.086567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2be04dcf-9ec3-4369-ae32-823964a5b935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598b026fa0>]}
[0m18:43:16.088207 [info ] [MainThread]: 
[0m18:43:16.090620 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:43:16.092505 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m18:43:16.093359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:16.539459 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m18:43:16.544100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:16.896901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2be04dcf-9ec3-4369-ae32-823964a5b935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59683b9730>]}
[0m18:43:16.898574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:43:16.899715 [info ] [MainThread]: 
[0m18:43:16.915566 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m18:43:16.917097 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m18:43:16.918871 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m18:43:16.920228 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m18:43:16.924495 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m18:43:16.932293 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 18:43:16.921355 => 2025-04-06 18:43:16.932184
[0m18:43:16.933564 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m18:43:17.005039 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m18:43:17.013901 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:43:17.047840 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact`
    
    cluster by year, month
    OPTIONS()
    as (
      

WITH casted AS (
    SELECT
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
         SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S%z', TRIM(OCCURRED_ON_DATE)) 
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
)

SELECT * FROM casted
    );
  
[0m18:43:23.821175 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:ca4537bb-38bf-4005-a4c5-b3a93c0a1e04&page=queryresults
[0m18:43:23.839970 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 18:43:16.934420 => 2025-04-06 18:43:23.839905
[0m18:43:23.841895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2be04dcf-9ec3-4369-ae32-823964a5b935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5989f05640>]}
[0m18:43:23.843477 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.incident_fact ............. [[32mCREATE TABLE (832.4k rows, 121.8 MB processed)[0m in 6.92s]
[0m18:43:23.846102 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m18:43:23.848992 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:43:23.850982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:23.852166 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m18:43:23.853117 [info ] [MainThread]: 
[0m18:43:23.853966 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.76 seconds (7.76s).
[0m18:43:23.854898 [debug] [MainThread]: Command end result
[0m18:43:23.874289 [info ] [MainThread]: 
[0m18:43:23.875547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:43:23.876937 [info ] [MainThread]: 
[0m18:43:23.878103 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:43:23.879278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5989eb7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5989eb7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5989eb7640>]}
[0m18:43:23.880286 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 18:50:36.835945 | 40416f94-4600-40a7-9a87-a62f8578f1bb ==============================
[0m18:50:36.835945 [info ] [MainThread]: Running with dbt=1.4.9
[0m18:50:36.838928 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:50:36.840254 [debug] [MainThread]: Tracking: tracking
[0m18:50:36.847139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8ebfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8ebfdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8ebff10>]}
[0m18:50:36.867753 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m18:50:36.956355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:50:36.957687 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/incident_fact.sql
[0m18:50:36.983599 [debug] [MainThread]: 1699: static parser successfully parsed mart/incident_fact.sql
[0m18:50:37.016351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40416f94-4600-40a7-9a87-a62f8578f1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96cacf00d0>]}
[0m18:50:37.031899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40416f94-4600-40a7-9a87-a62f8578f1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96cbb69fa0>]}
[0m18:50:37.033157 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:50:37.034164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40416f94-4600-40a7-9a87-a62f8578f1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96cbb69fd0>]}
[0m18:50:37.035855 [info ] [MainThread]: 
[0m18:50:37.038621 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:50:37.040787 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m18:50:37.041875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:37.464858 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m18:50:37.466373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:37.799474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40416f94-4600-40a7-9a87-a62f8578f1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96cbb91c70>]}
[0m18:50:37.801674 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:50:37.803235 [info ] [MainThread]: 
[0m18:50:37.820648 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m18:50:37.822390 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m18:50:37.824250 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m18:50:37.825449 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m18:50:37.829921 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m18:50:37.838040 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 18:50:37.826585 => 2025-04-06 18:50:37.837943
[0m18:50:37.838913 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m18:50:37.885859 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:38.266450 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m18:50:38.274523 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact` as DBT_INTERNAL_DEST
        using (

WITH casted AS (
    SELECT
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        DATETIME(SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S%z', TRIM(OCCURRED_ON_DATE))) 
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
)

SELECT * FROM casted
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.incident_number = DBT_INTERNAL_DEST.incident_number
            )

    
    when matched then update set
        `incident_number` = DBT_INTERNAL_SOURCE.`incident_number`,`offense_code` = DBT_INTERNAL_SOURCE.`offense_code`,`offense_code_group` = DBT_INTERNAL_SOURCE.`offense_code_group`,`offense_description` = DBT_INTERNAL_SOURCE.`offense_description`,`district` = DBT_INTERNAL_SOURCE.`district`,`reporting_area` = DBT_INTERNAL_SOURCE.`reporting_area`,`shooting` = DBT_INTERNAL_SOURCE.`shooting`,`occurred_on_datetime` = DBT_INTERNAL_SOURCE.`occurred_on_datetime`,`year` = DBT_INTERNAL_SOURCE.`year`,`month` = DBT_INTERNAL_SOURCE.`month`,`day_of_week` = DBT_INTERNAL_SOURCE.`day_of_week`,`hour` = DBT_INTERNAL_SOURCE.`hour`,`ucr_part` = DBT_INTERNAL_SOURCE.`ucr_part`,`street` = DBT_INTERNAL_SOURCE.`street`,`lat` = DBT_INTERNAL_SOURCE.`lat`,`long` = DBT_INTERNAL_SOURCE.`long`
    

    when not matched then insert
        (`incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `ucr_part`, `street`, `lat`, `long`)
    values
        (`incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `ucr_part`, `street`, `lat`, `long`)


    
[0m18:50:38.752491 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Value of type DATETIME cannot be assigned to occurred_on_datetime, which has type TIMESTAMP at [53:418]; reason: invalidQuery, location: query, message: Value of type DATETIME cannot be assigned to occurred_on_datetime, which has type TIMESTAMP at [53:418]')
[0m18:50:39.868885 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:ba6825a8-d6e8-4913-809d-edb9d7f328e6&page=queryresults
[0m18:50:39.874398 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 18:50:37.839535 => 2025-04-06 18:50:39.874157
[0m18:50:39.888388 [debug] [Thread-1  ]: Database Error in model incident_fact (models/mart/incident_fact.sql)
  Value of type DATETIME cannot be assigned to occurred_on_datetime, which has type TIMESTAMP at [53:418]
  compiled Code at target/run/boston_crime_project/models/mart/incident_fact.sql
[0m18:50:39.889648 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40416f94-4600-40a7-9a87-a62f8578f1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c89b9490>]}
[0m18:50:39.890632 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model boston_crime.incident_fact ......... [[31mERROR[0m in 2.07s]
[0m18:50:39.893278 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m18:50:39.895998 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:50:39.897224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:39.898065 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m18:50:39.898794 [info ] [MainThread]: 
[0m18:50:39.899638 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m18:50:39.901035 [debug] [MainThread]: Command end result
[0m18:50:39.916499 [info ] [MainThread]: 
[0m18:50:39.917573 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:50:39.918454 [info ] [MainThread]: 
[0m18:50:39.919315 [error] [MainThread]: [33mDatabase Error in model incident_fact (models/mart/incident_fact.sql)[0m
[0m18:50:39.920200 [error] [MainThread]:   Value of type DATETIME cannot be assigned to occurred_on_datetime, which has type TIMESTAMP at [53:418]
[0m18:50:39.921062 [error] [MainThread]:   compiled Code at target/run/boston_crime_project/models/mart/incident_fact.sql
[0m18:50:39.921977 [info ] [MainThread]: 
[0m18:50:39.922887 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:50:39.923886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96cbb69c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d36a9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c8a0dbb0>]}
[0m18:50:39.925098 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 18:51:49.932534 | ea9dbce4-2059-452f-abe1-e2510a1a26c2 ==============================
[0m18:51:49.932534 [info ] [MainThread]: Running with dbt=1.4.9
[0m18:51:49.935099 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:51:49.936389 [debug] [MainThread]: Tracking: tracking
[0m18:51:49.943040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02158ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02158fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02158fdf0>]}
[0m18:51:49.965474 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m18:51:50.048527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:51:50.049571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:51:50.057212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea9dbce4-2059-452f-abe1-e2510a1a26c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0441ef0d0>]}
[0m18:51:50.073901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea9dbce4-2059-452f-abe1-e2510a1a26c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0442beb50>]}
[0m18:51:50.075076 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:51:50.076114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea9dbce4-2059-452f-abe1-e2510a1a26c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0442bebe0>]}
[0m18:51:50.078030 [info ] [MainThread]: 
[0m18:51:50.081000 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:51:50.083460 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m18:51:50.084817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:50.470746 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m18:51:50.475161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:50.882564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea9dbce4-2059-452f-abe1-e2510a1a26c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc044220fa0>]}
[0m18:51:50.884634 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:51:50.886239 [info ] [MainThread]: 
[0m18:51:50.901267 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m18:51:50.902809 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m18:51:50.904658 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m18:51:50.905984 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m18:51:50.910622 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m18:51:50.919424 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 18:51:50.907093 => 2025-04-06 18:51:50.919252
[0m18:51:50.920836 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m18:51:50.996021 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m18:51:51.003309 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:51:51.037365 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact`
    
    cluster by year, month
    OPTIONS()
    as (
      

WITH casted AS (
    SELECT
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        DATETIME(SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S%z', TRIM(OCCURRED_ON_DATE))) 
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
)

SELECT * FROM casted
    );
  
[0m18:51:57.790734 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:b0ce6c9d-4926-4bb9-9225-2db292d45261&page=queryresults
[0m18:51:57.813733 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 18:51:50.922069 => 2025-04-06 18:51:57.813670
[0m18:51:57.815789 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea9dbce4-2059-452f-abe1-e2510a1a26c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc044100fd0>]}
[0m18:51:57.817449 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.incident_fact ............. [[32mCREATE TABLE (832.4k rows, 121.8 MB processed)[0m in 6.91s]
[0m18:51:57.820179 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m18:51:57.823030 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:51:57.824206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:57.824843 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m18:51:57.825465 [info ] [MainThread]: 
[0m18:51:57.826257 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m18:51:57.827146 [debug] [MainThread]: Command end result
[0m18:51:57.839687 [info ] [MainThread]: 
[0m18:51:57.840686 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:51:57.841540 [info ] [MainThread]: 
[0m18:51:57.842369 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:51:57.843346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc044142d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0430b19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0430b1a30>]}
[0m18:51:57.844159 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 19:00:14.732884 | 87d159e6-6d7d-4989-a234-3061a4e4a2ab ==============================
[0m19:00:14.732884 [info ] [MainThread]: Running with dbt=1.4.9
[0m19:00:14.737007 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:00:14.738058 [debug] [MainThread]: Tracking: tracking
[0m19:00:14.744254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235ccbff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235ccbfe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235ccbfee0>]}
[0m19:00:14.773332 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m19:00:14.893711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:00:14.894997 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/incident_fact.sql
[0m19:00:14.935319 [debug] [MainThread]: 1699: static parser successfully parsed mart/incident_fact.sql
[0m19:00:14.982190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87d159e6-6d7d-4989-a234-3061a4e4a2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237eaf40d0>]}
[0m19:00:15.008806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87d159e6-6d7d-4989-a234-3061a4e4a2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237f969ee0>]}
[0m19:00:15.010076 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:00:15.011321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87d159e6-6d7d-4989-a234-3061a4e4a2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237f969fa0>]}
[0m19:00:15.013677 [info ] [MainThread]: 
[0m19:00:15.016980 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:00:15.019964 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m19:00:15.021853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:15.467123 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m19:00:15.468289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:15.812569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87d159e6-6d7d-4989-a234-3061a4e4a2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235ccf57f0>]}
[0m19:00:15.814167 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:15.815297 [info ] [MainThread]: 
[0m19:00:15.833164 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m19:00:15.834547 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m19:00:15.836577 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m19:00:15.838412 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m19:00:15.842778 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m19:00:15.850647 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 19:00:15.839432 => 2025-04-06 19:00:15.850546
[0m19:00:15.851531 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m19:00:15.940245 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m19:00:15.950701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:15.995364 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact`
    
    cluster by year, month
    OPTIONS()
    as (
      

WITH casted AS (
    SELECT
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        SAFE_CAST(TRIM(REPLACE(OCCURRED_ON_DATE, '+00', '')) AS DATETIME)
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
)

SELECT * FROM casted
    );
  
[0m19:00:25.952920 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:e1a182d1-4e86-4740-b87e-29686e3a6d7a&page=queryresults
[0m19:00:25.973554 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 19:00:15.852520 => 2025-04-06 19:00:25.973485
[0m19:00:25.975807 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87d159e6-6d7d-4989-a234-3061a4e4a2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237c80ea60>]}
[0m19:00:25.977761 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.incident_fact ............. [[32mCREATE TABLE (832.4k rows, 121.8 MB processed)[0m in 10.14s]
[0m19:00:25.981512 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m19:00:25.985289 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:00:25.987057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:25.988718 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m19:00:25.989776 [info ] [MainThread]: 
[0m19:00:25.990991 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.97 seconds (10.97s).
[0m19:00:25.992111 [debug] [MainThread]: Command end result
[0m19:00:26.012082 [info ] [MainThread]: 
[0m19:00:26.013335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:26.014547 [info ] [MainThread]: 
[0m19:00:26.015749 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:00:26.016976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237eaf4f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237eaf40a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f237eaf4c40>]}
[0m19:00:26.018022 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 19:12:01.587824 | 3e3d0c84-9152-4f09-9a45-fc5119acf550 ==============================
[0m19:12:01.587824 [info ] [MainThread]: Running with dbt=1.4.9
[0m19:12:01.590080 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:12:01.590829 [debug] [MainThread]: Tracking: tracking
[0m19:12:01.598573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaacdf3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaacdf3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaacdf3dc0>]}
[0m19:12:01.619616 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m19:12:01.730458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:12:01.731880 [debug] [MainThread]: Partial parsing: added file: boston_crime_project://models/mart/district_dim.sql
[0m19:12:01.732894 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/sources/boston_crime.yml
[0m19:12:01.758754 [debug] [MainThread]: 1699: static parser successfully parsed mart/district_dim.sql
[0m19:12:01.775038 [debug] [MainThread]: 1699: static parser successfully parsed mart/incident_fact.sql
[0m19:12:01.815682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e3d0c84-9152-4f09-9a45-fc5119acf550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffacec1f0d0>]}
[0m19:12:01.831938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e3d0c84-9152-4f09-9a45-fc5119acf550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffacfb19ca0>]}
[0m19:12:01.833081 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m19:12:01.834394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e3d0c84-9152-4f09-9a45-fc5119acf550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffacfb19d30>]}
[0m19:12:01.836373 [info ] [MainThread]: 
[0m19:12:01.839038 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:12:01.840928 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m19:12:01.841904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:02.280282 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m19:12:02.281899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:12:02.629911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e3d0c84-9152-4f09-9a45-fc5119acf550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaace0ea00>]}
[0m19:12:02.635610 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:12:02.639178 [info ] [MainThread]: 
[0m19:12:02.666047 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m19:12:02.667462 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m19:12:02.669293 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m19:12:02.670373 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m19:12:02.674808 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m19:12:02.683749 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 19:12:02.671542 => 2025-04-06 19:12:02.683621
[0m19:12:02.684661 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m19:12:02.736284 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:12:03.123137 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m19:12:03.131642 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact` as DBT_INTERNAL_DEST
        using (

WITH casted AS (
    SELECT
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        SAFE_CAST(TRIM(REPLACE(OCCURRED_ON_DATE, '+00', '')) AS DATETIME)
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
)

SELECT * FROM casted
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.incident_number = DBT_INTERNAL_DEST.incident_number
            )

    
    when matched then update set
        `incident_number` = DBT_INTERNAL_SOURCE.`incident_number`,`offense_code` = DBT_INTERNAL_SOURCE.`offense_code`,`offense_code_group` = DBT_INTERNAL_SOURCE.`offense_code_group`,`offense_description` = DBT_INTERNAL_SOURCE.`offense_description`,`district` = DBT_INTERNAL_SOURCE.`district`,`reporting_area` = DBT_INTERNAL_SOURCE.`reporting_area`,`shooting` = DBT_INTERNAL_SOURCE.`shooting`,`occurred_on_datetime` = DBT_INTERNAL_SOURCE.`occurred_on_datetime`,`year` = DBT_INTERNAL_SOURCE.`year`,`month` = DBT_INTERNAL_SOURCE.`month`,`day_of_week` = DBT_INTERNAL_SOURCE.`day_of_week`,`hour` = DBT_INTERNAL_SOURCE.`hour`,`ucr_part` = DBT_INTERNAL_SOURCE.`ucr_part`,`street` = DBT_INTERNAL_SOURCE.`street`,`lat` = DBT_INTERNAL_SOURCE.`lat`,`long` = DBT_INTERNAL_SOURCE.`long`
    

    when not matched then insert
        (`incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `ucr_part`, `street`, `lat`, `long`)
    values
        (`incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `ucr_part`, `street`, `lat`, `long`)


    
[0m19:12:05.420853 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/galvanic-flame-447801-n5/queries/85af0cfc-92d0-4652-885c-6b67b89aca82?maxResults=0&location=us-east1&prettyPrint=false: UPDATE/MERGE must match at most one source row for each target row')
[0m19:12:08.178319 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:a4130cc5-2fc0-4b11-b0cd-abc1a28d926c&page=queryresults
[0m19:12:08.179733 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 19:12:02.685468 => 2025-04-06 19:12:08.179660
[0m19:12:08.183356 [debug] [Thread-1  ]: Database Error in model incident_fact (models/mart/incident_fact.sql)
  UPDATE/MERGE must match at most one source row for each target row
  compiled Code at target/run/boston_crime_project/models/mart/incident_fact.sql
[0m19:12:08.184493 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e3d0c84-9152-4f09-9a45-fc5119acf550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffacc9358b0>]}
[0m19:12:08.185461 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model boston_crime.incident_fact ......... [[31mERROR[0m in 5.52s]
[0m19:12:08.187642 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m19:12:08.190423 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:12:08.191780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:08.192658 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m19:12:08.193571 [info ] [MainThread]: 
[0m19:12:08.194624 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.36 seconds (6.36s).
[0m19:12:08.195790 [debug] [MainThread]: Command end result
[0m19:12:08.207827 [info ] [MainThread]: 
[0m19:12:08.209005 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:12:08.209990 [info ] [MainThread]: 
[0m19:12:08.210861 [error] [MainThread]: [33mDatabase Error in model incident_fact (models/mart/incident_fact.sql)[0m
[0m19:12:08.211732 [error] [MainThread]:   UPDATE/MERGE must match at most one source row for each target row
[0m19:12:08.212646 [error] [MainThread]:   compiled Code at target/run/boston_crime_project/models/mart/incident_fact.sql
[0m19:12:08.213486 [info ] [MainThread]: 
[0m19:12:08.214412 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:12:08.215430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffacc94f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffacc935040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffacc9387f0>]}
[0m19:12:08.216343 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 19:31:27.184289 | e466c14a-ede3-41f1-a24b-094f4a597d47 ==============================
[0m19:31:27.184289 [info ] [MainThread]: Running with dbt=1.4.9
[0m19:31:27.187702 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:31:27.189070 [debug] [MainThread]: Tracking: tracking
[0m19:31:27.196719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f983782fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f983782fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f983782fdf0>]}
[0m19:31:27.237771 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m19:31:27.364510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:31:27.365949 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/incident_fact.sql
[0m19:31:27.404861 [debug] [MainThread]: 1699: static parser successfully parsed mart/incident_fact.sql
[0m19:31:27.444840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e466c14a-ede3-41f1-a24b-094f4a597d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985d4650d0>]}
[0m19:31:27.463402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e466c14a-ede3-41f1-a24b-094f4a597d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985e4e5b50>]}
[0m19:31:27.464573 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m19:31:27.466048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e466c14a-ede3-41f1-a24b-094f4a597d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985e4e5ca0>]}
[0m19:31:27.468444 [info ] [MainThread]: 
[0m19:31:27.471439 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:31:27.473819 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m19:31:27.474896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:31:27.938928 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m19:31:27.940500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:31:28.304603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e466c14a-ede3-41f1-a24b-094f4a597d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f983782fca0>]}
[0m19:31:28.306599 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:31:28.307641 [info ] [MainThread]: 
[0m19:31:28.325247 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m19:31:28.326532 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m19:31:28.328038 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m19:31:28.328948 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m19:31:28.333828 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m19:31:28.341526 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 19:31:28.329801 => 2025-04-06 19:31:28.341395
[0m19:31:28.342462 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m19:31:28.427001 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m19:31:28.442316 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:31:28.494981 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact`
    
    cluster by year, month
    OPTIONS()
    as (
      

WITH casted AS (
    SELECT DISTINCT 
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        SAFE_CAST(TRIM(REPLACE(OCCURRED_ON_DATE, '+00', '')) AS DATETIME)
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
)


SELECT * FROM casted
    );
  
[0m19:31:39.404844 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:9053fbfd-623e-40f5-97b2-25fdf47f9990&page=queryresults
[0m19:31:39.430311 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 19:31:28.343207 => 2025-04-06 19:31:39.430247
[0m19:31:39.432011 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e466c14a-ede3-41f1-a24b-094f4a597d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985d3806a0>]}
[0m19:31:39.433723 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.incident_fact ............. [[32mCREATE TABLE (831.8k rows, 121.8 MB processed)[0m in 11.10s]
[0m19:31:39.436467 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m19:31:39.439776 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:31:39.441722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:31:39.442635 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m19:31:39.443712 [info ] [MainThread]: 
[0m19:31:39.444887 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.97 seconds (11.97s).
[0m19:31:39.446267 [debug] [MainThread]: Command end result
[0m19:31:39.464773 [info ] [MainThread]: 
[0m19:31:39.466151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:31:39.467871 [info ] [MainThread]: 
[0m19:31:39.469282 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:31:39.470742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985d3c0d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985d3c0df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985d3c0e50>]}
[0m19:31:39.471851 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 19:48:14.545608 | 47b2a2b3-1de7-4d6c-8f82-2322e441e32f ==============================
[0m19:48:14.545608 [info ] [MainThread]: Running with dbt=1.4.9
[0m19:48:14.548248 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:48:14.549466 [debug] [MainThread]: Tracking: tracking
[0m19:48:14.555021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242f648b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242f648df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242f648e80>]}
[0m19:48:14.576912 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m19:48:14.685817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:48:14.687584 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/district_dim.sql
[0m19:48:14.689768 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/incident_fact.sql
[0m19:48:14.719459 [debug] [MainThread]: 1699: static parser successfully parsed mart/district_dim.sql
[0m19:48:14.735205 [debug] [MainThread]: 1699: static parser successfully parsed mart/incident_fact.sql
[0m19:48:14.759118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47b2a2b3-1de7-4d6c-8f82-2322e441e32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24552500d0>]}
[0m19:48:14.779753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47b2a2b3-1de7-4d6c-8f82-2322e441e32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245630ec10>]}
[0m19:48:14.780908 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m19:48:14.781913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47b2a2b3-1de7-4d6c-8f82-2322e441e32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245630eca0>]}
[0m19:48:14.783947 [info ] [MainThread]: 
[0m19:48:14.786658 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:48:14.788505 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m19:48:14.789547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:15.227887 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m19:48:15.229355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:48:15.588811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47b2a2b3-1de7-4d6c-8f82-2322e441e32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242f65d6a0>]}
[0m19:48:15.590930 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:48:15.592431 [info ] [MainThread]: 
[0m19:48:15.608386 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m19:48:15.609965 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m19:48:15.611782 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m19:48:15.613122 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m19:48:15.617295 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m19:48:15.625395 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 19:48:15.614097 => 2025-04-06 19:48:15.625280
[0m19:48:15.626506 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m19:48:15.702273 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m19:48:15.709862 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:48:15.743215 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact`
    
    cluster by year, month
    OPTIONS()
    as (
      

WITH casted AS (
    SELECT DISTINCT 
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        SAFE_CAST(TRIM(REPLACE(OCCURRED_ON_DATE, '+00', '')) AS DATETIME)
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
), deduped AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY incident_number, offense_code ORDER BY occurred_on_datetime DESC) AS row_num
    FROM casted
    WHERE incident_number IS NOT NULL
      AND offense_code IS NOT NULL
)


SELECT CONCAT(incident_number, offense_code)AS incident_offense_key,
        * FROM casted 
WHERE row_num = 1
    );
  
[0m19:48:16.411442 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: row_num at [51:7]; reason: invalidQuery, location: query, message: Unrecognized name: row_num at [51:7]')
[0m19:48:17.644746 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:ff0433a7-469b-4a88-abfb-86f19d067b2b&page=queryresults
[0m19:48:17.649465 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 19:48:15.627536 => 2025-04-06 19:48:17.649262
[0m19:48:17.655035 [debug] [Thread-1  ]: Database Error in model incident_fact (models/mart/incident_fact.sql)
  Unrecognized name: row_num at [51:7]
  compiled Code at target/run/boston_crime_project/models/mart/incident_fact.sql
[0m19:48:17.656797 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b2a2b3-1de7-4d6c-8f82-2322e441e32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24551e75e0>]}
[0m19:48:17.658569 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model boston_crime.incident_fact ......... [[31mERROR[0m in 2.05s]
[0m19:48:17.660892 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m19:48:17.663959 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:48:17.665248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:17.665975 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m19:48:17.666693 [info ] [MainThread]: 
[0m19:48:17.667543 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m19:48:17.668457 [debug] [MainThread]: Command end result
[0m19:48:17.681243 [info ] [MainThread]: 
[0m19:48:17.682233 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:48:17.683038 [info ] [MainThread]: 
[0m19:48:17.683844 [error] [MainThread]: [33mDatabase Error in model incident_fact (models/mart/incident_fact.sql)[0m
[0m19:48:17.684685 [error] [MainThread]:   Unrecognized name: row_num at [51:7]
[0m19:48:17.685526 [error] [MainThread]:   compiled Code at target/run/boston_crime_project/models/mart/incident_fact.sql
[0m19:48:17.686307 [info ] [MainThread]: 
[0m19:48:17.687265 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:48:17.688259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245630e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245637d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f242f6a4af0>]}
[0m19:48:17.689393 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 19:50:03.885858 | 46640c03-a098-4c64-81db-74c7fcc130d7 ==============================
[0m19:50:03.885858 [info ] [MainThread]: Running with dbt=1.4.9
[0m19:50:03.888876 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:50:03.890039 [debug] [MainThread]: Tracking: tracking
[0m19:50:03.898046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab1aa6880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab1aa6e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab1aa6e80>]}
[0m19:50:03.920483 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m19:50:04.053550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:50:04.055430 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/incident_fact.sql
[0m19:50:04.095893 [debug] [MainThread]: 1699: static parser successfully parsed mart/incident_fact.sql
[0m19:50:04.132512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46640c03-a098-4c64-81db-74c7fcc130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad36d60d0>]}
[0m19:50:04.146111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46640c03-a098-4c64-81db-74c7fcc130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad4754c40>]}
[0m19:50:04.147348 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m19:50:04.148766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46640c03-a098-4c64-81db-74c7fcc130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad4754cd0>]}
[0m19:50:04.151351 [info ] [MainThread]: 
[0m19:50:04.154761 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:50:04.157368 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m19:50:04.159127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:04.585634 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m19:50:04.588575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:04.947946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46640c03-a098-4c64-81db-74c7fcc130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ab1b04af0>]}
[0m19:50:04.953671 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:50:04.957363 [info ] [MainThread]: 
[0m19:50:04.987723 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m19:50:04.989271 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m19:50:04.990945 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m19:50:04.992055 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m19:50:04.996598 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m19:50:05.003877 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 19:50:04.993026 => 2025-04-06 19:50:05.003741
[0m19:50:05.004765 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m19:50:05.083230 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m19:50:05.091623 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:50:05.125641 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact`
    
    cluster by year, month
    OPTIONS()
    as (
      

WITH casted AS (
    SELECT DISTINCT 
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        SAFE_CAST(TRIM(REPLACE(OCCURRED_ON_DATE, '+00', '')) AS DATETIME)
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
), deduped AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY incident_number, offense_code ORDER BY occurred_on_datetime DESC) AS row_num
    FROM casted
    WHERE incident_number IS NOT NULL
      AND offense_code IS NOT NULL
)


SELECT CONCAT(incident_number, offense_code)AS incident_offense_key,
        * FROM deduped 
WHERE row_num = 1
    );
  
[0m19:50:13.830718 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:bacd29d4-04f5-4ae6-a77d-36012e4c085f&page=queryresults
[0m19:50:13.848582 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 19:50:05.005420 => 2025-04-06 19:50:13.848520
[0m19:50:13.850373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46640c03-a098-4c64-81db-74c7fcc130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad3614e20>]}
[0m19:50:13.851746 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.incident_fact ............. [[32mCREATE TABLE (831.8k rows, 121.8 MB processed)[0m in 8.86s]
[0m19:50:13.854556 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m19:50:13.858112 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:50:13.859599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:13.860775 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m19:50:13.861507 [info ] [MainThread]: 
[0m19:50:13.862583 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.71 seconds (9.71s).
[0m19:50:13.863827 [debug] [MainThread]: Command end result
[0m19:50:13.881556 [info ] [MainThread]: 
[0m19:50:13.882684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:50:13.883642 [info ] [MainThread]: 
[0m19:50:13.884548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:50:13.885646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad3607d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad3607340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad3607d90>]}
[0m19:50:13.886650 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 19:50:20.071286 | ed8a73cd-e2ca-4199-b42a-449c862a01d7 ==============================
[0m19:50:20.071286 [info ] [MainThread]: Running with dbt=1.4.9
[0m19:50:20.073715 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['district_dim'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:50:20.074726 [debug] [MainThread]: Tracking: tracking
[0m19:50:20.083021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0949778b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0949778e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0949778eb0>]}
[0m19:50:20.106727 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m19:50:20.204296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:50:20.205306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:50:20.213255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed8a73cd-e2ca-4199-b42a-449c862a01d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096c3da0d0>]}
[0m19:50:20.230583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed8a73cd-e2ca-4199-b42a-449c862a01d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096c4982e0>]}
[0m19:50:20.232125 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m19:50:20.233815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed8a73cd-e2ca-4199-b42a-449c862a01d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096c4980d0>]}
[0m19:50:20.236582 [info ] [MainThread]: 
[0m19:50:20.240161 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:50:20.243191 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m19:50:20.244284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:20.614416 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m19:50:20.615848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:20.933785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed8a73cd-e2ca-4199-b42a-449c862a01d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096c40b490>]}
[0m19:50:20.935877 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:50:20.937578 [info ] [MainThread]: 
[0m19:50:20.952379 [debug] [Thread-1  ]: Began running node model.boston_crime_project.district_dim
[0m19:50:20.954189 [info ] [Thread-1  ]: 1 of 1 START sql table model boston_crime.district_dim ......................... [RUN]
[0m19:50:20.956003 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.district_dim'
[0m19:50:20.957258 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.district_dim
[0m19:50:20.960923 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.district_dim"
[0m19:50:21.424670 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (compile): 2025-04-06 19:50:20.958145 => 2025-04-06 19:50:21.424468
[0m19:50:21.426265 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.district_dim
[0m19:50:21.468895 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.district_dim"
[0m19:50:21.515672 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:50:21.549057 [debug] [Thread-1  ]: On model.boston_crime_project.district_dim: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.district_dim"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`district_dim`
    
    
    OPTIONS()
    as (
      

SELECT
  NULLIF(TRIM(neighborhood), '') AS neighborhood,
  NULLIF(TRIM(district), '') AS district
FROM `galvanic-flame-447801-n5`.`boston_crime`.`police_districts_stg`
    );
  
[0m19:50:23.819166 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:4c13e5cc-7f9b-4b7f-a8b3-d25373a8dbf8&page=queryresults
[0m19:50:23.840709 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (execute): 2025-04-06 19:50:21.427437 => 2025-04-06 19:50:23.840518
[0m19:50:23.842931 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8a73cd-e2ca-4199-b42a-449c862a01d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096c2e9d60>]}
[0m19:50:23.845113 [info ] [Thread-1  ]: 1 of 1 OK created sql table model boston_crime.district_dim .................... [[32mCREATE TABLE (13.0 rows, 199.0 Bytes processed)[0m in 2.89s]
[0m19:50:23.848203 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.district_dim
[0m19:50:23.851907 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:50:23.853363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:23.854826 [debug] [MainThread]: Connection 'model.boston_crime_project.district_dim' was properly closed.
[0m19:50:23.856045 [info ] [MainThread]: 
[0m19:50:23.857566 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m19:50:23.858883 [debug] [MainThread]: Command end result
[0m19:50:23.882596 [info ] [MainThread]: 
[0m19:50:23.883718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:50:23.884616 [info ] [MainThread]: 
[0m19:50:23.885622 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:50:23.886824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0973f5d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096c33e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096c33e2e0>]}
[0m19:50:23.887652 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 19:50:59.530568 | 68755e0f-d552-46f7-8880-f24f11b022ae ==============================
[0m19:50:59.530568 [info ] [MainThread]: Running with dbt=1.4.9
[0m19:50:59.533234 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:50:59.534346 [debug] [MainThread]: Tracking: tracking
[0m19:50:59.541845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e6621fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e6621d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e6621e80>]}
[0m19:50:59.563369 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m19:50:59.655153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:50:59.656213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:50:59.663117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68755e0f-d552-46f7-8880-f24f11b022ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8092830d0>]}
[0m19:50:59.679396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68755e0f-d552-46f7-8880-f24f11b022ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80933d220>]}
[0m19:50:59.680480 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m19:50:59.681608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68755e0f-d552-46f7-8880-f24f11b022ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80933d040>]}
[0m19:50:59.683876 [info ] [MainThread]: 
[0m19:50:59.686868 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:50:59.688929 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m19:50:59.689965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:00.075655 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m19:51:00.077083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:00.402698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68755e0f-d552-46f7-8880-f24f11b022ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8092c8be0>]}
[0m19:51:00.404782 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:51:00.406206 [info ] [MainThread]: 
[0m19:51:00.421440 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m19:51:00.422983 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m19:51:00.424581 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m19:51:00.425811 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m19:51:00.430337 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m19:51:00.438987 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 19:51:00.426956 => 2025-04-06 19:51:00.438864
[0m19:51:00.440096 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m19:51:00.484052 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:51:00.804447 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m19:51:00.813517 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact` as DBT_INTERNAL_DEST
        using (

WITH casted AS (
    SELECT DISTINCT 
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        SAFE_CAST(TRIM(REPLACE(OCCURRED_ON_DATE, '+00', '')) AS DATETIME)
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
), deduped AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY incident_number, offense_code ORDER BY occurred_on_datetime DESC) AS row_num
    FROM casted
    WHERE incident_number IS NOT NULL
      AND offense_code IS NOT NULL
)


SELECT CONCAT(incident_number, offense_code)AS incident_offense_key,
        * FROM deduped 
WHERE row_num = 1
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.incident_offense_key = DBT_INTERNAL_DEST.incident_offense_key
            )

    
    when matched then update set
        `incident_offense_key` = DBT_INTERNAL_SOURCE.`incident_offense_key`,`incident_number` = DBT_INTERNAL_SOURCE.`incident_number`,`offense_code` = DBT_INTERNAL_SOURCE.`offense_code`,`offense_code_group` = DBT_INTERNAL_SOURCE.`offense_code_group`,`offense_description` = DBT_INTERNAL_SOURCE.`offense_description`,`district` = DBT_INTERNAL_SOURCE.`district`,`reporting_area` = DBT_INTERNAL_SOURCE.`reporting_area`,`shooting` = DBT_INTERNAL_SOURCE.`shooting`,`occurred_on_datetime` = DBT_INTERNAL_SOURCE.`occurred_on_datetime`,`year` = DBT_INTERNAL_SOURCE.`year`,`month` = DBT_INTERNAL_SOURCE.`month`,`day_of_week` = DBT_INTERNAL_SOURCE.`day_of_week`,`hour` = DBT_INTERNAL_SOURCE.`hour`,`ucr_part` = DBT_INTERNAL_SOURCE.`ucr_part`,`street` = DBT_INTERNAL_SOURCE.`street`,`lat` = DBT_INTERNAL_SOURCE.`lat`,`long` = DBT_INTERNAL_SOURCE.`long`,`row_num` = DBT_INTERNAL_SOURCE.`row_num`
    

    when not matched then insert
        (`incident_offense_key`, `incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `ucr_part`, `street`, `lat`, `long`, `row_num`)
    values
        (`incident_offense_key`, `incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `ucr_part`, `street`, `lat`, `long`, `row_num`)


    
[0m19:51:18.166534 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:cb846d67-8090-4026-bb79-697e242ed139&page=queryresults
[0m19:51:18.184164 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 19:51:00.440941 => 2025-04-06 19:51:18.184103
[0m19:51:18.186069 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68755e0f-d552-46f7-8880-f24f11b022ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff809192040>]}
[0m19:51:18.187573 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.incident_fact ............. [[32mMERGE (831.8k rows, 252.7 MB processed)[0m in 17.76s]
[0m19:51:18.190680 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m19:51:18.195031 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:51:18.196735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:18.198197 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m19:51:18.199934 [info ] [MainThread]: 
[0m19:51:18.201181 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 18.51 seconds (18.51s).
[0m19:51:18.202612 [debug] [MainThread]: Command end result
[0m19:51:18.216512 [info ] [MainThread]: 
[0m19:51:18.217667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:51:18.218560 [info ] [MainThread]: 
[0m19:51:18.219443 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:51:18.220465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e664f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80933d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e6640670>]}
[0m19:51:18.221292 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 19:51:24.259139 | 8be1246e-20b0-41ad-ab05-6d8a45ad085d ==============================
[0m19:51:24.259139 [info ] [MainThread]: Running with dbt=1.4.9
[0m19:51:24.261543 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['district_dim'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:51:24.262781 [debug] [MainThread]: Tracking: tracking
[0m19:51:24.271274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f2a73f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f2a73d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f2a73d30>]}
[0m19:51:24.294374 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m19:51:24.384666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:24.385811 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:24.393541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8be1246e-20b0-41ad-ab05-6d8a45ad085d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22196d60d0>]}
[0m19:51:24.411056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8be1246e-20b0-41ad-ab05-6d8a45ad085d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2219790220>]}
[0m19:51:24.412255 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m19:51:24.413404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8be1246e-20b0-41ad-ab05-6d8a45ad085d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2219790040>]}
[0m19:51:24.415436 [info ] [MainThread]: 
[0m19:51:24.418006 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:51:24.419807 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m19:51:24.420764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:24.790940 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m19:51:24.794880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:25.115244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8be1246e-20b0-41ad-ab05-6d8a45ad085d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f221971ab80>]}
[0m19:51:25.116828 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:51:25.117834 [info ] [MainThread]: 
[0m19:51:25.136111 [debug] [Thread-1  ]: Began running node model.boston_crime_project.district_dim
[0m19:51:25.137232 [info ] [Thread-1  ]: 1 of 1 START sql table model boston_crime.district_dim ......................... [RUN]
[0m19:51:25.138490 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.district_dim'
[0m19:51:25.139232 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.district_dim
[0m19:51:25.142844 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.district_dim"
[0m19:51:25.148715 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (compile): 2025-04-06 19:51:25.139906 => 2025-04-06 19:51:25.148615
[0m19:51:25.149491 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.district_dim
[0m19:51:25.166514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:51:25.526055 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.district_dim"
[0m19:51:25.535853 [debug] [Thread-1  ]: On model.boston_crime_project.district_dim: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.district_dim"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`district_dim`
    
    
    OPTIONS()
    as (
      

SELECT
  NULLIF(TRIM(neighborhood), '') AS neighborhood,
  NULLIF(TRIM(district), '') AS district
FROM `galvanic-flame-447801-n5`.`boston_crime`.`police_districts_stg`
    );
  
[0m19:51:27.621388 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:5642bcde-4158-4334-9c3d-5d4973a2a509&page=queryresults
[0m19:51:27.640070 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (execute): 2025-04-06 19:51:25.150194 => 2025-04-06 19:51:27.640011
[0m19:51:27.641851 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8be1246e-20b0-41ad-ab05-6d8a45ad085d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22195e4190>]}
[0m19:51:27.643248 [info ] [Thread-1  ]: 1 of 1 OK created sql table model boston_crime.district_dim .................... [[32mCREATE TABLE (13.0 rows, 199.0 Bytes processed)[0m in 2.50s]
[0m19:51:27.645841 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.district_dim
[0m19:51:27.648672 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:51:27.649988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:27.650858 [debug] [MainThread]: Connection 'model.boston_crime_project.district_dim' was properly closed.
[0m19:51:27.651840 [info ] [MainThread]: 
[0m19:51:27.652863 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m19:51:27.654207 [debug] [MainThread]: Command end result
[0m19:51:27.674321 [info ] [MainThread]: 
[0m19:51:27.675375 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:51:27.676328 [info ] [MainThread]: 
[0m19:51:27.677200 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:51:27.678238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22212591c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22195ea220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22195ea940>]}
[0m19:51:27.679039 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 19:55:26.871537 | 6e1f2327-a304-42be-b9b6-31da08206bae ==============================
[0m19:55:26.871537 [info ] [MainThread]: Running with dbt=1.4.9
[0m19:55:26.873869 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:55:26.875057 [debug] [MainThread]: Tracking: tracking
[0m19:55:26.884473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f460d295f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f460d295d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f460d295df0>]}
[0m19:55:26.908134 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m19:55:27.030878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:55:27.032678 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/incident_fact.sql
[0m19:55:27.065680 [debug] [MainThread]: 1699: static parser successfully parsed mart/incident_fact.sql
[0m19:55:27.096739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e1f2327-a304-42be-b9b6-31da08206bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462eec50d0>]}
[0m19:55:27.113984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e1f2327-a304-42be-b9b6-31da08206bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462ff3b9a0>]}
[0m19:55:27.114904 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m19:55:27.115799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e1f2327-a304-42be-b9b6-31da08206bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f460d2f2ca0>]}
[0m19:55:27.117870 [info ] [MainThread]: 
[0m19:55:27.120972 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:55:27.123160 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m19:55:27.124426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:27.553502 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m19:55:27.554785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:27.868555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e1f2327-a304-42be-b9b6-31da08206bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462ff45040>]}
[0m19:55:27.870772 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:55:27.872063 [info ] [MainThread]: 
[0m19:55:27.889991 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m19:55:27.891634 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m19:55:27.893343 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m19:55:27.894244 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m19:55:27.899020 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m19:55:27.906488 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 19:55:27.895127 => 2025-04-06 19:55:27.906333
[0m19:55:27.907492 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m19:55:27.988347 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m19:55:27.999841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:28.036855 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact`
    
    cluster by year, month
    OPTIONS()
    as (
      

WITH casted AS (
    SELECT DISTINCT 
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        SAFE_CAST(TRIM(REPLACE(OCCURRED_ON_DATE, '+00', '')) AS DATETIME)
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
), deduped AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY incident_number, offense_code ORDER BY occurred_on_datetime DESC) AS row_num
    FROM casted
    WHERE incident_number IS NOT NULL
      AND offense_code IS NOT NULL
)


SELECT CONCAT(incident_number, offense_code)AS incident_offense_key,
        incident_number,
        offense_code,
        offense_code_group,
        offense_description,
        district,
        reporting_area,
        shooting,
        occurred_on_datetime,
        year,
        month,
        day_of_week,
        hour,
        street,
        lat,
        long
FROM deduped 
WHERE row_num = 1
    );
  
[0m19:55:38.497257 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:3acdb2fc-e19e-4cfe-9ec2-4428db872f49&page=queryresults
[0m19:55:38.516507 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 19:55:27.908267 => 2025-04-06 19:55:38.516436
[0m19:55:38.518647 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e1f2327-a304-42be-b9b6-31da08206bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462ee1c580>]}
[0m19:55:38.520413 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.incident_fact ............. [[32mCREATE TABLE (831.8k rows, 121.8 MB processed)[0m in 10.63s]
[0m19:55:38.523367 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m19:55:38.526911 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:55:38.528346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:38.529359 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m19:55:38.530220 [info ] [MainThread]: 
[0m19:55:38.531398 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.41 seconds (11.41s).
[0m19:55:38.532741 [debug] [MainThread]: Command end result
[0m19:55:38.554606 [info ] [MainThread]: 
[0m19:55:38.556119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:55:38.557325 [info ] [MainThread]: 
[0m19:55:38.558594 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:55:38.560345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462eddde80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462eddde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462edddfa0>]}
[0m19:55:38.561589 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 19:55:45.273436 | 95338275-5251-457c-b02b-c9d356780fcc ==============================
[0m19:55:45.273436 [info ] [MainThread]: Running with dbt=1.4.9
[0m19:55:45.276462 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['district_dim'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:55:45.277594 [debug] [MainThread]: Tracking: tracking
[0m19:55:45.285412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f640845df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f640845dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f640845dd60>]}
[0m19:55:45.315072 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m19:55:45.441342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:55:45.442439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:55:45.452263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95338275-5251-457c-b02b-c9d356780fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f642b0b90d0>]}
[0m19:55:45.473191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95338275-5251-457c-b02b-c9d356780fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f642b178250>]}
[0m19:55:45.474775 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m19:55:45.476492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95338275-5251-457c-b02b-c9d356780fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f642b1780d0>]}
[0m19:55:45.479101 [info ] [MainThread]: 
[0m19:55:45.482631 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:55:45.485925 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m19:55:45.487491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:45.876842 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m19:55:45.878035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:46.179341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95338275-5251-457c-b02b-c9d356780fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f642b0ffc40>]}
[0m19:55:46.181037 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:55:46.182296 [info ] [MainThread]: 
[0m19:55:46.200228 [debug] [Thread-1  ]: Began running node model.boston_crime_project.district_dim
[0m19:55:46.201663 [info ] [Thread-1  ]: 1 of 1 START sql table model boston_crime.district_dim ......................... [RUN]
[0m19:55:46.203178 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.district_dim'
[0m19:55:46.204170 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.district_dim
[0m19:55:46.208425 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.district_dim"
[0m19:55:46.215818 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (compile): 2025-04-06 19:55:46.205104 => 2025-04-06 19:55:46.215681
[0m19:55:46.216941 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.district_dim
[0m19:55:46.241466 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:46.639900 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.district_dim"
[0m19:55:46.649825 [debug] [Thread-1  ]: On model.boston_crime_project.district_dim: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.district_dim"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`district_dim`
    
    
    OPTIONS()
    as (
      

SELECT
  NULLIF(TRIM(neighborhood), '') AS neighborhood,
  NULLIF(TRIM(district), '') AS district
FROM `galvanic-flame-447801-n5`.`boston_crime`.`police_districts_stg`
    );
  
[0m19:55:48.409689 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:c54d814d-4e4e-4703-919c-d10c92ebc61d&page=queryresults
[0m19:55:48.430825 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (execute): 2025-04-06 19:55:46.217853 => 2025-04-06 19:55:48.430763
[0m19:55:48.432356 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95338275-5251-457c-b02b-c9d356780fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f642afc81c0>]}
[0m19:55:48.433655 [info ] [Thread-1  ]: 1 of 1 OK created sql table model boston_crime.district_dim .................... [[32mCREATE TABLE (13.0 rows, 199.0 Bytes processed)[0m in 2.23s]
[0m19:55:48.436020 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.district_dim
[0m19:55:48.439371 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:55:48.440684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:48.441530 [debug] [MainThread]: Connection 'model.boston_crime_project.district_dim' was properly closed.
[0m19:55:48.442406 [info ] [MainThread]: 
[0m19:55:48.443299 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m19:55:48.444333 [debug] [MainThread]: Command end result
[0m19:55:48.465713 [info ] [MainThread]: 
[0m19:55:48.467087 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:55:48.468258 [info ] [MainThread]: 
[0m19:55:48.469462 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:55:48.470547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6432c3e1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64084b9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f642affbee0>]}
[0m19:55:48.471524 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 19:57:57.281768 | bdcb2922-4420-4e5e-beee-d6a3bb620d8e ==============================
[0m19:57:57.281768 [info ] [MainThread]: Running with dbt=1.4.9
[0m19:57:57.284446 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:57:57.285737 [debug] [MainThread]: Tracking: tracking
[0m19:57:57.293553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08318c0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08318c0d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08318c0d60>]}
[0m19:57:57.318108 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m19:57:57.425339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:57:57.426885 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/district_dim.sql
[0m19:57:57.454409 [debug] [MainThread]: 1699: static parser successfully parsed mart/district_dim.sql
[0m19:57:57.483378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdcb2922-4420-4e5e-beee-d6a3bb620d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08536ef0d0>]}
[0m19:57:57.500455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdcb2922-4420-4e5e-beee-d6a3bb620d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0854570bb0>]}
[0m19:57:57.501718 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m19:57:57.502764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdcb2922-4420-4e5e-beee-d6a3bb620d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0854570c40>]}
[0m19:57:57.504594 [info ] [MainThread]: 
[0m19:57:57.507161 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:57:57.509224 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m19:57:57.510065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:57.951252 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m19:57:57.952948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:58.270907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdcb2922-4420-4e5e-beee-d6a3bb620d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0854566c70>]}
[0m19:57:58.272740 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:57:58.274175 [info ] [MainThread]: 
[0m19:57:58.288913 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m19:57:58.290680 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m19:57:58.292624 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m19:57:58.293907 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m19:57:58.298144 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m19:57:58.306729 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 19:57:58.295015 => 2025-04-06 19:57:58.306621
[0m19:57:58.307592 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m19:57:58.351727 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:58.676728 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m19:57:58.685196 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact` as DBT_INTERNAL_DEST
        using (

WITH casted AS (
    SELECT DISTINCT 
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        SAFE_CAST(TRIM(REPLACE(OCCURRED_ON_DATE, '+00', '')) AS DATETIME)
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
), deduped AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY incident_number, offense_code ORDER BY occurred_on_datetime DESC) AS row_num
    FROM casted
    WHERE incident_number IS NOT NULL
      AND offense_code IS NOT NULL
)


SELECT CONCAT(incident_number, offense_code)AS incident_offense_key,
        incident_number,
        offense_code,
        offense_code_group,
        offense_description,
        district,
        reporting_area,
        shooting,
        occurred_on_datetime,
        year,
        month,
        day_of_week,
        hour,
        street,
        lat,
        long
FROM deduped 
WHERE row_num = 1
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.incident_offense_key = DBT_INTERNAL_DEST.incident_offense_key
            )

    
    when matched then update set
        `incident_offense_key` = DBT_INTERNAL_SOURCE.`incident_offense_key`,`incident_number` = DBT_INTERNAL_SOURCE.`incident_number`,`offense_code` = DBT_INTERNAL_SOURCE.`offense_code`,`offense_code_group` = DBT_INTERNAL_SOURCE.`offense_code_group`,`offense_description` = DBT_INTERNAL_SOURCE.`offense_description`,`district` = DBT_INTERNAL_SOURCE.`district`,`reporting_area` = DBT_INTERNAL_SOURCE.`reporting_area`,`shooting` = DBT_INTERNAL_SOURCE.`shooting`,`occurred_on_datetime` = DBT_INTERNAL_SOURCE.`occurred_on_datetime`,`year` = DBT_INTERNAL_SOURCE.`year`,`month` = DBT_INTERNAL_SOURCE.`month`,`day_of_week` = DBT_INTERNAL_SOURCE.`day_of_week`,`hour` = DBT_INTERNAL_SOURCE.`hour`,`street` = DBT_INTERNAL_SOURCE.`street`,`lat` = DBT_INTERNAL_SOURCE.`lat`,`long` = DBT_INTERNAL_SOURCE.`long`
    

    when not matched then insert
        (`incident_offense_key`, `incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `street`, `lat`, `long`)
    values
        (`incident_offense_key`, `incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `street`, `lat`, `long`)


    
[0m19:58:15.194270 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:283df8fe-b10e-4c8d-9ce2-4085749fb07b&page=queryresults
[0m19:58:15.212021 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 19:57:58.308261 => 2025-04-06 19:58:15.211936
[0m19:58:15.213520 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdcb2922-4420-4e5e-beee-d6a3bb620d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08513f6dc0>]}
[0m19:58:15.214656 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.incident_fact ............. [[32mMERGE (831.8k rows, 242.6 MB processed)[0m in 16.92s]
[0m19:58:15.217006 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m19:58:15.219857 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:58:15.220904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:15.221567 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m19:58:15.222219 [info ] [MainThread]: 
[0m19:58:15.223027 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 17.72 seconds (17.72s).
[0m19:58:15.223896 [debug] [MainThread]: Command end result
[0m19:58:15.242550 [info ] [MainThread]: 
[0m19:58:15.243929 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:58:15.245233 [info ] [MainThread]: 
[0m19:58:15.246362 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:58:15.247446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f083191cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085144bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085144b7f0>]}
[0m19:58:15.248218 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 19:58:20.421913 | 575d5577-7b54-49aa-90ce-18456b5cb2b8 ==============================
[0m19:58:20.421913 [info ] [MainThread]: Running with dbt=1.4.9
[0m19:58:20.424794 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['district_dim'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:58:20.425901 [debug] [MainThread]: Tracking: tracking
[0m19:58:20.433213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158ca7ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158ca7fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158ca7fd60>]}
[0m19:58:20.458155 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m19:58:20.561435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:58:20.562323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:58:20.570817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '575d5577-7b54-49aa-90ce-18456b5cb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15af6e30d0>]}
[0m19:58:20.587688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '575d5577-7b54-49aa-90ce-18456b5cb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15af79a220>]}
[0m19:58:20.589046 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m19:58:20.590264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '575d5577-7b54-49aa-90ce-18456b5cb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15af79a040>]}
[0m19:58:20.592488 [info ] [MainThread]: 
[0m19:58:20.595497 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:58:20.597986 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m19:58:20.599112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:21.222971 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m19:58:21.224075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:58:21.522363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '575d5577-7b54-49aa-90ce-18456b5cb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158cadc9a0>]}
[0m19:58:21.524270 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:58:21.525708 [info ] [MainThread]: 
[0m19:58:21.540189 [debug] [Thread-1  ]: Began running node model.boston_crime_project.district_dim
[0m19:58:21.541725 [info ] [Thread-1  ]: 1 of 1 START sql table model boston_crime.district_dim ......................... [RUN]
[0m19:58:21.543367 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.district_dim'
[0m19:58:21.544348 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.district_dim
[0m19:58:21.548111 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.district_dim"
[0m19:58:21.555431 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (compile): 2025-04-06 19:58:21.545370 => 2025-04-06 19:58:21.555325
[0m19:58:21.556240 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.district_dim
[0m19:58:21.596590 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.district_dim"
[0m19:58:21.605637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:58:21.639165 [debug] [Thread-1  ]: On model.boston_crime_project.district_dim: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.district_dim"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`district_dim`
    
    
    OPTIONS()
    as (
      

SELECT
  NULLIF(TRIM(district), '') AS district_code,
  NULLIF(TRIM(neighborhood), '') AS neighborhood
FROM `galvanic-flame-447801-n5`.`boston_crime`.`police_districts_stg`
WHERE district IS NOT NULL
  AND neighborhood IS NOT NULL
    );
  
[0m19:58:23.839727 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:17640a31-3e5e-4eee-90b3-719a67c1d932&page=queryresults
[0m19:58:23.864674 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (execute): 2025-04-06 19:58:21.556905 => 2025-04-06 19:58:23.864561
[0m19:58:23.866876 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '575d5577-7b54-49aa-90ce-18456b5cb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15af635dc0>]}
[0m19:58:23.868889 [info ] [Thread-1  ]: 1 of 1 OK created sql table model boston_crime.district_dim .................... [[32mCREATE TABLE (12.0 rows, 199.0 Bytes processed)[0m in 2.32s]
[0m19:58:23.872127 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.district_dim
[0m19:58:23.875853 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:58:23.877807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:23.878742 [debug] [MainThread]: Connection 'model.boston_crime_project.district_dim' was properly closed.
[0m19:58:23.879723 [info ] [MainThread]: 
[0m19:58:23.880775 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m19:58:23.882596 [debug] [MainThread]: Command end result
[0m19:58:23.910301 [info ] [MainThread]: 
[0m19:58:23.911624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:58:23.913168 [info ] [MainThread]: 
[0m19:58:23.914576 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:58:23.916307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b7266220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15af628670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15af628970>]}
[0m19:58:23.917770 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 20:02:40.523699 | a323ac41-4e79-4627-ae33-15dfc49326be ==============================
[0m20:02:40.523699 [info ] [MainThread]: Running with dbt=1.4.9
[0m20:02:40.526208 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:02:40.527231 [debug] [MainThread]: Tracking: tracking
[0m20:02:40.534554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a37f8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a37f8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a37f8d60>]}
[0m20:02:40.558175 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m20:02:40.672044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:02:40.673878 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/district_dim.sql
[0m20:02:40.704648 [debug] [MainThread]: 1699: static parser successfully parsed mart/district_dim.sql
[0m20:02:40.738485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a323ac41-4e79-4627-ae33-15dfc49326be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c962d0d0>]}
[0m20:02:40.755788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a323ac41-4e79-4627-ae33-15dfc49326be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca4a6a00>]}
[0m20:02:40.756834 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m20:02:40.757895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a323ac41-4e79-4627-ae33-15dfc49326be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca4a6fd0>]}
[0m20:02:40.759942 [info ] [MainThread]: 
[0m20:02:40.763373 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:02:40.765782 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m20:02:40.767074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:41.225645 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m20:02:41.227040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:41.549806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a323ac41-4e79-4627-ae33-15dfc49326be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca51e280>]}
[0m20:02:41.551501 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:02:41.552674 [info ] [MainThread]: 
[0m20:02:41.568998 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m20:02:41.570628 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m20:02:41.572533 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m20:02:41.573564 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m20:02:41.578089 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m20:02:41.586389 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 20:02:41.574637 => 2025-04-06 20:02:41.586248
[0m20:02:41.587261 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m20:02:41.638493 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:02:41.963637 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m20:02:41.972708 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact` as DBT_INTERNAL_DEST
        using (

WITH casted AS (
    SELECT DISTINCT 
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        SAFE_CAST(TRIM(REPLACE(OCCURRED_ON_DATE, '+00', '')) AS DATETIME)
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
), deduped AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY incident_number, offense_code ORDER BY occurred_on_datetime DESC) AS row_num
    FROM casted
    WHERE incident_number IS NOT NULL
      AND offense_code IS NOT NULL
)


SELECT CONCAT(incident_number, offense_code)AS incident_offense_key,
        incident_number,
        offense_code,
        offense_code_group,
        offense_description,
        district,
        reporting_area,
        shooting,
        occurred_on_datetime,
        year,
        month,
        day_of_week,
        hour,
        street,
        lat,
        long
FROM deduped 
WHERE row_num = 1
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.incident_offense_key = DBT_INTERNAL_DEST.incident_offense_key
            )

    
    when matched then update set
        `incident_offense_key` = DBT_INTERNAL_SOURCE.`incident_offense_key`,`incident_number` = DBT_INTERNAL_SOURCE.`incident_number`,`offense_code` = DBT_INTERNAL_SOURCE.`offense_code`,`offense_code_group` = DBT_INTERNAL_SOURCE.`offense_code_group`,`offense_description` = DBT_INTERNAL_SOURCE.`offense_description`,`district` = DBT_INTERNAL_SOURCE.`district`,`reporting_area` = DBT_INTERNAL_SOURCE.`reporting_area`,`shooting` = DBT_INTERNAL_SOURCE.`shooting`,`occurred_on_datetime` = DBT_INTERNAL_SOURCE.`occurred_on_datetime`,`year` = DBT_INTERNAL_SOURCE.`year`,`month` = DBT_INTERNAL_SOURCE.`month`,`day_of_week` = DBT_INTERNAL_SOURCE.`day_of_week`,`hour` = DBT_INTERNAL_SOURCE.`hour`,`street` = DBT_INTERNAL_SOURCE.`street`,`lat` = DBT_INTERNAL_SOURCE.`lat`,`long` = DBT_INTERNAL_SOURCE.`long`
    

    when not matched then insert
        (`incident_offense_key`, `incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `street`, `lat`, `long`)
    values
        (`incident_offense_key`, `incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `street`, `lat`, `long`)


    
[0m20:03:00.833578 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:a32ef88d-97fe-4b78-8cfc-ab44118a0122&page=queryresults
[0m20:03:00.853898 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 20:02:41.587935 => 2025-04-06 20:03:00.853833
[0m20:03:00.855573 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a323ac41-4e79-4627-ae33-15dfc49326be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c734c610>]}
[0m20:03:00.856818 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.incident_fact ............. [[32mMERGE (831.8k rows, 242.6 MB processed)[0m in 19.28s]
[0m20:03:00.859227 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m20:03:00.862814 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:03:00.864403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:00.865253 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m20:03:00.866071 [info ] [MainThread]: 
[0m20:03:00.867049 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 20.10 seconds (20.10s).
[0m20:03:00.868444 [debug] [MainThread]: Command end result
[0m20:03:00.889233 [info ] [MainThread]: 
[0m20:03:00.890476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:03:00.891827 [info ] [MainThread]: 
[0m20:03:00.892848 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:03:00.894059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a3855ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca51e280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c737c6a0>]}
[0m20:03:00.895199 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 20:03:05.989913 | 2ec4a615-1655-484f-8b66-148216dd9628 ==============================
[0m20:03:05.989913 [info ] [MainThread]: Running with dbt=1.4.9
[0m20:03:05.992359 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['district_dim'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:03:05.993204 [debug] [MainThread]: Tracking: tracking
[0m20:03:06.000201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20bd294fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20bd294df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20bd294d90>]}
[0m20:03:06.020316 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m20:03:06.113952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:03:06.114992 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:03:06.121701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ec4a615-1655-484f-8b66-148216dd9628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20dfef80d0>]}
[0m20:03:06.138661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ec4a615-1655-484f-8b66-148216dd9628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20dffb2250>]}
[0m20:03:06.139717 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m20:03:06.140938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec4a615-1655-484f-8b66-148216dd9628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20dffb20d0>]}
[0m20:03:06.143027 [info ] [MainThread]: 
[0m20:03:06.145834 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:03:06.148014 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m20:03:06.149089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:06.515536 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m20:03:06.516957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:03:06.801562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec4a615-1655-484f-8b66-148216dd9628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20dff3ec40>]}
[0m20:03:06.803593 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:03:06.804959 [info ] [MainThread]: 
[0m20:03:06.828635 [debug] [Thread-1  ]: Began running node model.boston_crime_project.district_dim
[0m20:03:06.829921 [info ] [Thread-1  ]: 1 of 1 START sql table model boston_crime.district_dim ......................... [RUN]
[0m20:03:06.832031 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.district_dim'
[0m20:03:06.833287 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.district_dim
[0m20:03:06.837616 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.district_dim"
[0m20:03:06.845777 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (compile): 2025-04-06 20:03:06.834182 => 2025-04-06 20:03:06.845635
[0m20:03:06.846965 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.district_dim
[0m20:03:06.870322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:03:07.185707 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.district_dim"
[0m20:03:07.194450 [debug] [Thread-1  ]: On model.boston_crime_project.district_dim: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.district_dim"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`district_dim`
    
    
    OPTIONS()
    as (
      

SELECT
  CASE WHEN NULLIF(TRIM(district), '') == 'A1' THEN 'Downtown'
       WHEN NULLIF(TRIM(district), '') == 'D4' THEN 'South End'
       ELSE NULLIF(TRIM(district), '') END AS district_code,
  NULLIF(TRIM(neighborhood), '') AS neighborhood
FROM `galvanic-flame-447801-n5`.`boston_crime`.`police_districts_stg`
WHERE district IS NOT NULL
  AND neighborhood IS NOT NULL
    );
  
[0m20:03:07.391768 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "=" at [14:41]; reason: invalidQuery, location: query, message: Syntax error: Unexpected "=" at [14:41]')
[0m20:03:08.223949 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:US:1277867c-2289-4c97-9f08-a1355fe5b9f1&page=queryresults
[0m20:03:08.225358 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (execute): 2025-04-06 20:03:06.847859 => 2025-04-06 20:03:08.225270
[0m20:03:08.229227 [debug] [Thread-1  ]: Database Error in model district_dim (models/mart/district_dim.sql)
  Syntax error: Unexpected "=" at [14:41]
  compiled Code at target/run/boston_crime_project/models/mart/district_dim.sql
[0m20:03:08.230203 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec4a615-1655-484f-8b66-148216dd9628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20dfe06c70>]}
[0m20:03:08.231207 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model boston_crime.district_dim ................ [[31mERROR[0m in 1.40s]
[0m20:03:08.233193 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.district_dim
[0m20:03:08.235483 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:03:08.236505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:08.237145 [debug] [MainThread]: Connection 'model.boston_crime_project.district_dim' was properly closed.
[0m20:03:08.237837 [info ] [MainThread]: 
[0m20:03:08.238670 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m20:03:08.239546 [debug] [MainThread]: Command end result
[0m20:03:08.256527 [info ] [MainThread]: 
[0m20:03:08.257745 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:03:08.258910 [info ] [MainThread]: 
[0m20:03:08.259796 [error] [MainThread]: [33mDatabase Error in model district_dim (models/mart/district_dim.sql)[0m
[0m20:03:08.260869 [error] [MainThread]:   Syntax error: Unexpected "=" at [14:41]
[0m20:03:08.261895 [error] [MainThread]:   compiled Code at target/run/boston_crime_project/models/mart/district_dim.sql
[0m20:03:08.262738 [info ] [MainThread]: 
[0m20:03:08.263645 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:03:08.264814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20dfe48a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20dfe48550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20dfe48850>]}
[0m20:03:08.265642 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 20:05:29.788890 | 716938e6-be39-4b9f-8158-9c55eefd6836 ==============================
[0m20:05:29.788890 [info ] [MainThread]: Running with dbt=1.4.9
[0m20:05:29.791404 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:05:29.792830 [debug] [MainThread]: Tracking: tracking
[0m20:05:29.799613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71647f3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71647f3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71647f3df0>]}
[0m20:05:29.821179 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m20:05:29.929573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:05:29.930887 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/district_dim.sql
[0m20:05:29.959454 [debug] [MainThread]: 1699: static parser successfully parsed mart/district_dim.sql
[0m20:05:29.990862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '716938e6-be39-4b9f-8158-9c55eefd6836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f718661e0d0>]}
[0m20:05:30.007154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '716938e6-be39-4b9f-8158-9c55eefd6836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71874a0c10>]}
[0m20:05:30.008353 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m20:05:30.009777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '716938e6-be39-4b9f-8158-9c55eefd6836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71874a0ca0>]}
[0m20:05:30.011731 [info ] [MainThread]: 
[0m20:05:30.014477 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:05:30.018032 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m20:05:30.019149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:30.409366 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m20:05:30.413608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:30.722993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '716938e6-be39-4b9f-8158-9c55eefd6836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71647f3d90>]}
[0m20:05:30.725099 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:30.727221 [info ] [MainThread]: 
[0m20:05:30.744937 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m20:05:30.746778 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m20:05:30.748194 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m20:05:30.749248 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m20:05:30.753342 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m20:05:30.759588 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 20:05:30.749904 => 2025-04-06 20:05:30.759484
[0m20:05:30.760727 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m20:05:30.808281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:31.186103 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m20:05:31.196384 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact` as DBT_INTERNAL_DEST
        using (

WITH casted AS (
    SELECT DISTINCT 
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        SAFE_CAST(TRIM(REPLACE(OCCURRED_ON_DATE, '+00', '')) AS DATETIME)
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
), deduped AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY incident_number, offense_code ORDER BY occurred_on_datetime DESC) AS row_num
    FROM casted
    WHERE incident_number IS NOT NULL
      AND offense_code IS NOT NULL
)


SELECT CONCAT(incident_number, offense_code)AS incident_offense_key,
        incident_number,
        offense_code,
        offense_code_group,
        offense_description,
        district,
        reporting_area,
        shooting,
        occurred_on_datetime,
        year,
        month,
        day_of_week,
        hour,
        street,
        lat,
        long
FROM deduped 
WHERE row_num = 1
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.incident_offense_key = DBT_INTERNAL_DEST.incident_offense_key
            )

    
    when matched then update set
        `incident_offense_key` = DBT_INTERNAL_SOURCE.`incident_offense_key`,`incident_number` = DBT_INTERNAL_SOURCE.`incident_number`,`offense_code` = DBT_INTERNAL_SOURCE.`offense_code`,`offense_code_group` = DBT_INTERNAL_SOURCE.`offense_code_group`,`offense_description` = DBT_INTERNAL_SOURCE.`offense_description`,`district` = DBT_INTERNAL_SOURCE.`district`,`reporting_area` = DBT_INTERNAL_SOURCE.`reporting_area`,`shooting` = DBT_INTERNAL_SOURCE.`shooting`,`occurred_on_datetime` = DBT_INTERNAL_SOURCE.`occurred_on_datetime`,`year` = DBT_INTERNAL_SOURCE.`year`,`month` = DBT_INTERNAL_SOURCE.`month`,`day_of_week` = DBT_INTERNAL_SOURCE.`day_of_week`,`hour` = DBT_INTERNAL_SOURCE.`hour`,`street` = DBT_INTERNAL_SOURCE.`street`,`lat` = DBT_INTERNAL_SOURCE.`lat`,`long` = DBT_INTERNAL_SOURCE.`long`
    

    when not matched then insert
        (`incident_offense_key`, `incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `street`, `lat`, `long`)
    values
        (`incident_offense_key`, `incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `street`, `lat`, `long`)


    
[0m20:05:48.813444 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:503fb99e-937a-4b4b-a25a-1623edf9b413&page=queryresults
[0m20:05:48.832404 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 20:05:30.761749 => 2025-04-06 20:05:48.832313
[0m20:05:48.834511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '716938e6-be39-4b9f-8158-9c55eefd6836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7184381df0>]}
[0m20:05:48.835782 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.incident_fact ............. [[32mMERGE (831.8k rows, 242.6 MB processed)[0m in 18.09s]
[0m20:05:48.838173 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m20:05:48.840574 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:05:48.841613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:48.842261 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m20:05:48.842916 [info ] [MainThread]: 
[0m20:05:48.843934 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 18.83 seconds (18.83s).
[0m20:05:48.845039 [debug] [MainThread]: Command end result
[0m20:05:48.864256 [info ] [MainThread]: 
[0m20:05:48.865819 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:48.866738 [info ] [MainThread]: 
[0m20:05:48.867658 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:05:48.868818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f718efd8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7184304100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7184304af0>]}
[0m20:05:48.869677 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 20:05:54.047080 | e93ee9f1-5bec-41da-926f-700bf9f63f52 ==============================
[0m20:05:54.047080 [info ] [MainThread]: Running with dbt=1.4.9
[0m20:05:54.049417 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['district_dim'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:05:54.050301 [debug] [MainThread]: Tracking: tracking
[0m20:05:54.056530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c784d9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c784d9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c784d9df0>]}
[0m20:05:54.079644 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m20:05:54.175059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:05:54.175949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:05:54.183110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e93ee9f1-5bec-41da-926f-700bf9f63f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c9b1390d0>]}
[0m20:05:54.200151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e93ee9f1-5bec-41da-926f-700bf9f63f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c9b1fa310>]}
[0m20:05:54.201352 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m20:05:54.202442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e93ee9f1-5bec-41da-926f-700bf9f63f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c9b1fa100>]}
[0m20:05:54.204472 [info ] [MainThread]: 
[0m20:05:54.207826 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:05:54.210172 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m20:05:54.211365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:54.602631 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m20:05:54.606593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:54.948289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e93ee9f1-5bec-41da-926f-700bf9f63f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c9b16a490>]}
[0m20:05:54.950472 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:54.951931 [info ] [MainThread]: 
[0m20:05:54.967179 [debug] [Thread-1  ]: Began running node model.boston_crime_project.district_dim
[0m20:05:54.968710 [info ] [Thread-1  ]: 1 of 1 START sql table model boston_crime.district_dim ......................... [RUN]
[0m20:05:54.970426 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.district_dim'
[0m20:05:54.971739 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.district_dim
[0m20:05:54.975716 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.district_dim"
[0m20:05:54.983492 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (compile): 2025-04-06 20:05:54.972981 => 2025-04-06 20:05:54.983394
[0m20:05:54.984337 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.district_dim
[0m20:05:55.001363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:55.415711 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.district_dim"
[0m20:05:55.425567 [debug] [Thread-1  ]: On model.boston_crime_project.district_dim: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.district_dim"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`district_dim`
    
    
    OPTIONS()
    as (
      

SELECT
  CASE WHEN NULLIF(TRIM(district), '') = 'A1' THEN 'Downtown'
       WHEN NULLIF(TRIM(district), '') = 'D4' THEN 'South End'
       ELSE NULLIF(TRIM(district), '') END AS district_code,
  NULLIF(TRIM(neighborhood), '') AS neighborhood
FROM `galvanic-flame-447801-n5`.`boston_crime`.`police_districts_stg`
WHERE district IS NOT NULL
  AND neighborhood IS NOT NULL
    );
  
[0m20:05:57.502248 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:13b76446-1686-424b-9ee3-b00ba4472ba8&page=queryresults
[0m20:05:57.523611 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (execute): 2025-04-06 20:05:54.984986 => 2025-04-06 20:05:57.523551
[0m20:05:57.525996 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93ee9f1-5bec-41da-926f-700bf9f63f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c9b07aeb0>]}
[0m20:05:57.527343 [info ] [Thread-1  ]: 1 of 1 OK created sql table model boston_crime.district_dim .................... [[32mCREATE TABLE (12.0 rows, 199.0 Bytes processed)[0m in 2.56s]
[0m20:05:57.529498 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.district_dim
[0m20:05:57.531863 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:05:57.532889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:57.533605 [debug] [MainThread]: Connection 'model.boston_crime_project.district_dim' was properly closed.
[0m20:05:57.534339 [info ] [MainThread]: 
[0m20:05:57.535290 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m20:05:57.536433 [debug] [MainThread]: Command end result
[0m20:05:57.556048 [info ] [MainThread]: 
[0m20:05:57.557330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:57.558615 [info ] [MainThread]: 
[0m20:05:57.559610 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:05:57.560794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca2cbd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c9b0a3af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c9b0a3d90>]}
[0m20:05:57.561694 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 20:09:52.268587 | 7c6e260b-f917-4e73-8c08-75c381312387 ==============================
[0m20:09:52.268587 [info ] [MainThread]: Running with dbt=1.4.9
[0m20:09:52.271396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:09:52.272518 [debug] [MainThread]: Tracking: tracking
[0m20:09:52.278421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f4610fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f4610dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f4610d90>]}
[0m20:09:52.300449 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m20:09:52.391747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:09:52.392943 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/district_dim.sql
[0m20:09:52.420055 [debug] [MainThread]: 1699: static parser successfully parsed mart/district_dim.sql
[0m20:09:52.449871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c6e260b-f917-4e73-8c08-75c381312387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73141c00d0>]}
[0m20:09:52.465165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c6e260b-f917-4e73-8c08-75c381312387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73172b3c10>]}
[0m20:09:52.466128 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m20:09:52.467097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c6e260b-f917-4e73-8c08-75c381312387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73172b3f70>]}
[0m20:09:52.468880 [info ] [MainThread]: 
[0m20:09:52.471381 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:09:52.473536 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m20:09:52.474567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:52.871680 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m20:09:52.876435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:09:53.257546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c6e260b-f917-4e73-8c08-75c381312387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7317327040>]}
[0m20:09:53.259682 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:09:53.261047 [info ] [MainThread]: 
[0m20:09:53.277240 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m20:09:53.278920 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m20:09:53.280782 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m20:09:53.282154 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m20:09:53.286547 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m20:09:53.293999 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 20:09:53.283463 => 2025-04-06 20:09:53.293905
[0m20:09:53.294800 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m20:09:53.338702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:09:53.665805 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m20:09:53.677417 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact` as DBT_INTERNAL_DEST
        using (

WITH casted AS (
    SELECT DISTINCT 
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        SAFE_CAST(TRIM(REPLACE(OCCURRED_ON_DATE, '+00', '')) AS DATETIME)
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
), deduped AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY incident_number, offense_code ORDER BY occurred_on_datetime DESC) AS row_num
    FROM casted
    WHERE incident_number IS NOT NULL
      AND offense_code IS NOT NULL
)


SELECT CONCAT(incident_number, offense_code)AS incident_offense_key,
        incident_number,
        offense_code,
        offense_code_group,
        offense_description,
        district,
        reporting_area,
        shooting,
        occurred_on_datetime,
        year,
        month,
        day_of_week,
        hour,
        street,
        lat,
        long
FROM deduped 
WHERE row_num = 1
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.incident_offense_key = DBT_INTERNAL_DEST.incident_offense_key
            )

    
    when matched then update set
        `incident_offense_key` = DBT_INTERNAL_SOURCE.`incident_offense_key`,`incident_number` = DBT_INTERNAL_SOURCE.`incident_number`,`offense_code` = DBT_INTERNAL_SOURCE.`offense_code`,`offense_code_group` = DBT_INTERNAL_SOURCE.`offense_code_group`,`offense_description` = DBT_INTERNAL_SOURCE.`offense_description`,`district` = DBT_INTERNAL_SOURCE.`district`,`reporting_area` = DBT_INTERNAL_SOURCE.`reporting_area`,`shooting` = DBT_INTERNAL_SOURCE.`shooting`,`occurred_on_datetime` = DBT_INTERNAL_SOURCE.`occurred_on_datetime`,`year` = DBT_INTERNAL_SOURCE.`year`,`month` = DBT_INTERNAL_SOURCE.`month`,`day_of_week` = DBT_INTERNAL_SOURCE.`day_of_week`,`hour` = DBT_INTERNAL_SOURCE.`hour`,`street` = DBT_INTERNAL_SOURCE.`street`,`lat` = DBT_INTERNAL_SOURCE.`lat`,`long` = DBT_INTERNAL_SOURCE.`long`
    

    when not matched then insert
        (`incident_offense_key`, `incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `street`, `lat`, `long`)
    values
        (`incident_offense_key`, `incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `street`, `lat`, `long`)


    
[0m20:10:10.614561 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:cd899abf-90e6-48a6-99c3-876897b6f310&page=queryresults
[0m20:10:10.634906 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 20:09:53.295465 => 2025-04-06 20:10:10.634804
[0m20:10:10.636630 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6e260b-f917-4e73-8c08-75c381312387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f731415e700>]}
[0m20:10:10.637832 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.incident_fact ............. [[32mMERGE (831.8k rows, 242.6 MB processed)[0m in 17.36s]
[0m20:10:10.640383 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m20:10:10.643702 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:10:10.645291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:10.646121 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m20:10:10.646880 [info ] [MainThread]: 
[0m20:10:10.647781 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 18.18 seconds (18.18s).
[0m20:10:10.648717 [debug] [MainThread]: Command end result
[0m20:10:10.665706 [info ] [MainThread]: 
[0m20:10:10.666710 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:10.667593 [info ] [MainThread]: 
[0m20:10:10.668448 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:10:10.669410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f731edf11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f46276a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73141906d0>]}
[0m20:10:10.670383 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 20:10:16.302251 | 8906e8df-f17c-4651-a439-8c2d21eacd5e ==============================
[0m20:10:16.302251 [info ] [MainThread]: Running with dbt=1.4.9
[0m20:10:16.304806 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['district_dim'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:10:16.306228 [debug] [MainThread]: Tracking: tracking
[0m20:10:16.313014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff840042f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff840042df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff840042dc0>]}
[0m20:10:16.336820 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m20:10:16.431004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:16.432216 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:16.439389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8906e8df-f17c-4651-a439-8c2d21eacd5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff862ca40d0>]}
[0m20:10:16.456244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8906e8df-f17c-4651-a439-8c2d21eacd5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff862d5e2b0>]}
[0m20:10:16.457296 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m20:10:16.458378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8906e8df-f17c-4651-a439-8c2d21eacd5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff862d5e0a0>]}
[0m20:10:16.460254 [info ] [MainThread]: 
[0m20:10:16.463036 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:10:16.465148 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m20:10:16.466263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:16.852842 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m20:10:16.854679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:17.138632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8906e8df-f17c-4651-a439-8c2d21eacd5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff862cce370>]}
[0m20:10:17.141013 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:17.142502 [info ] [MainThread]: 
[0m20:10:17.163798 [debug] [Thread-1  ]: Began running node model.boston_crime_project.district_dim
[0m20:10:17.165430 [info ] [Thread-1  ]: 1 of 1 START sql table model boston_crime.district_dim ......................... [RUN]
[0m20:10:17.167325 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.district_dim'
[0m20:10:17.168394 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.district_dim
[0m20:10:17.172672 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.district_dim"
[0m20:10:17.180845 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (compile): 2025-04-06 20:10:17.169242 => 2025-04-06 20:10:17.180655
[0m20:10:17.182164 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.district_dim
[0m20:10:17.205493 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:10:17.573115 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.district_dim"
[0m20:10:17.582219 [debug] [Thread-1  ]: On model.boston_crime_project.district_dim: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.district_dim"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`district_dim`
    
    
    OPTIONS()
    as (
      

SELECT
  NULLIF(TRIM(district), '') AS district_code,
  CASE WHEN NULLIF(TRIM(district), '') = 'A1' THEN 'Downtown'
       WHEN NULLIF(TRIM(district), '') = 'D4' THEN 'South End'
       ELSE NULLIF(TRIM(neighborhood), '') END AS neighborhood
FROM `galvanic-flame-447801-n5`.`boston_crime`.`police_districts_stg`
WHERE district IS NOT NULL
  AND neighborhood IS NOT NULL
    );
  
[0m20:10:19.668793 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:00370b21-223b-41da-9ec1-73cdbfcdca98&page=queryresults
[0m20:10:19.694818 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (execute): 2025-04-06 20:10:17.183021 => 2025-04-06 20:10:19.694734
[0m20:10:19.696447 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8906e8df-f17c-4651-a439-8c2d21eacd5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff862c14070>]}
[0m20:10:19.697521 [info ] [Thread-1  ]: 1 of 1 OK created sql table model boston_crime.district_dim .................... [[32mCREATE TABLE (12.0 rows, 199.0 Bytes processed)[0m in 2.53s]
[0m20:10:19.700250 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.district_dim
[0m20:10:19.702943 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:10:19.704197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:19.704988 [debug] [MainThread]: Connection 'model.boston_crime_project.district_dim' was properly closed.
[0m20:10:19.705864 [info ] [MainThread]: 
[0m20:10:19.706870 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m20:10:19.708253 [debug] [MainThread]: Command end result
[0m20:10:19.729786 [info ] [MainThread]: 
[0m20:10:19.731179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:19.732409 [info ] [MainThread]: 
[0m20:10:19.733776 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:10:19.734970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86a828250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff862be7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff862be7250>]}
[0m20:10:19.735985 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 22:04:14.967682 | 882260f4-5419-475f-9b52-9e0d2d882b55 ==============================
[0m22:04:14.967682 [info ] [MainThread]: Running with dbt=1.4.9
[0m22:04:14.970386 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:04:14.971777 [debug] [MainThread]: Tracking: tracking
[0m22:04:14.978118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b6f396eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b6f396f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b6f396e80>]}
[0m22:04:15.000763 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m22:04:15.132070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m22:04:15.133493 [debug] [MainThread]: Partial parsing: added file: boston_crime_project://models/mart/vw_incident_district.sql
[0m22:04:15.134718 [debug] [MainThread]: Partial parsing: updated file: boston_crime_project://models/mart/incident_fact.sql
[0m22:04:15.165420 [debug] [MainThread]: 1699: static parser successfully parsed mart/vw_incident_district.sql
[0m22:04:15.181277 [debug] [MainThread]: 1699: static parser successfully parsed mart/incident_fact.sql
[0m22:04:15.199994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '882260f4-5419-475f-9b52-9e0d2d882b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b94f8c0d0>]}
[0m22:04:15.213612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '882260f4-5419-475f-9b52-9e0d2d882b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b96048cd0>]}
[0m22:04:15.214565 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m22:04:15.215483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882260f4-5419-475f-9b52-9e0d2d882b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b96048d60>]}
[0m22:04:15.217392 [info ] [MainThread]: 
[0m22:04:15.219838 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:04:15.221638 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m22:04:15.222764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:15.822416 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m22:04:15.823637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:16.149772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882260f4-5419-475f-9b52-9e0d2d882b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b6f3f3d60>]}
[0m22:04:16.151751 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:04:16.153283 [info ] [MainThread]: 
[0m22:04:16.168606 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m22:04:16.170079 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m22:04:16.171644 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m22:04:16.172533 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m22:04:16.176663 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m22:04:16.183075 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 22:04:16.173421 => 2025-04-06 22:04:16.182891
[0m22:04:16.184176 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m22:04:16.255838 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m22:04:16.266020 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:04:16.298813 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact`
    
    cluster by year, month
    OPTIONS()
    as (
      

WITH casted AS (
    SELECT DISTINCT 
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district_code,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        SAFE_CAST(TRIM(REPLACE(OCCURRED_ON_DATE, '+00', '')) AS DATETIME)
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
), deduped AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY incident_number, offense_code ORDER BY occurred_on_datetime DESC) AS row_num
    FROM casted
    WHERE incident_number IS NOT NULL
      AND offense_code IS NOT NULL
)


SELECT CONCAT(incident_number, offense_code)AS incident_offense_key,
        incident_number,
        offense_code,
        offense_code_group,
        offense_description,
        district_code,
        reporting_area,
        shooting,
        occurred_on_datetime,
        year,
        month,
        day_of_week,
        hour,
        street,
        lat,
        long
FROM deduped 
WHERE row_num = 1
    );
  
[0m22:04:26.159974 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:fcd1bbf4-1bcb-4377-8eed-15d214412a53&page=queryresults
[0m22:04:26.176540 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 22:04:16.185039 => 2025-04-06 22:04:26.176480
[0m22:04:26.178501 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882260f4-5419-475f-9b52-9e0d2d882b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b94ea5610>]}
[0m22:04:26.179908 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.incident_fact ............. [[32mCREATE TABLE (831.8k rows, 121.8 MB processed)[0m in 10.01s]
[0m22:04:26.182466 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m22:04:26.185252 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:04:26.187007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:26.188481 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m22:04:26.189334 [info ] [MainThread]: 
[0m22:04:26.190531 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.97 seconds (10.97s).
[0m22:04:26.191716 [debug] [MainThread]: Command end result
[0m22:04:26.211773 [info ] [MainThread]: 
[0m22:04:26.212802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:04:26.213752 [info ] [MainThread]: 
[0m22:04:26.214646 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:04:26.215683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b94ea7ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b94ea76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b94ea71f0>]}
[0m22:04:26.216542 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 22:04:32.083996 | 48878891-6f41-489a-9e93-815f22941a8e ==============================
[0m22:04:32.083996 [info ] [MainThread]: Running with dbt=1.4.9
[0m22:04:32.086475 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['district_dim'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:04:32.087586 [debug] [MainThread]: Tracking: tracking
[0m22:04:32.094237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc086c6fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc086c6fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc086c6fd90>]}
[0m22:04:32.116667 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m22:04:32.221262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:04:32.222326 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:04:32.229804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48878891-6f41-489a-9e93-815f22941a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ad8ce0d0>]}
[0m22:04:32.248132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48878891-6f41-489a-9e93-815f22941a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ad9a1670>]}
[0m22:04:32.249524 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m22:04:32.250957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48878891-6f41-489a-9e93-815f22941a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ad9a16a0>]}
[0m22:04:32.253088 [info ] [MainThread]: 
[0m22:04:32.257000 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:04:32.259861 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m22:04:32.261340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:32.693725 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m22:04:32.698627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:33.012643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48878891-6f41-489a-9e93-815f22941a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ad9a16d0>]}
[0m22:04:33.014368 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:04:33.015821 [info ] [MainThread]: 
[0m22:04:33.031825 [debug] [Thread-1  ]: Began running node model.boston_crime_project.district_dim
[0m22:04:33.033092 [info ] [Thread-1  ]: 1 of 1 START sql table model boston_crime.district_dim ......................... [RUN]
[0m22:04:33.034809 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.district_dim'
[0m22:04:33.035681 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.district_dim
[0m22:04:33.040186 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.district_dim"
[0m22:04:33.048261 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (compile): 2025-04-06 22:04:33.036894 => 2025-04-06 22:04:33.048135
[0m22:04:33.049138 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.district_dim
[0m22:04:33.092298 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.district_dim"
[0m22:04:33.101340 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:04:33.137621 [debug] [Thread-1  ]: On model.boston_crime_project.district_dim: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.district_dim"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`district_dim`
    
    
    OPTIONS()
    as (
      

SELECT
  NULLIF(TRIM(district), '') AS district_code,
  CASE WHEN NULLIF(TRIM(district), '') = 'A1' THEN 'Downtown'
       WHEN NULLIF(TRIM(district), '') = 'D4' THEN 'South End'
       ELSE NULLIF(TRIM(neighborhood), '') END AS neighborhood
FROM `galvanic-flame-447801-n5`.`boston_crime`.`police_districts_stg`
WHERE district IS NOT NULL
  AND neighborhood IS NOT NULL
    );
  
[0m22:04:35.630888 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:f27b2ec2-6678-4080-8c62-acf37d2d4493&page=queryresults
[0m22:04:35.650446 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (execute): 2025-04-06 22:04:33.049785 => 2025-04-06 22:04:35.650386
[0m22:04:35.652558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48878891-6f41-489a-9e93-815f22941a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ad810eb0>]}
[0m22:04:35.654222 [info ] [Thread-1  ]: 1 of 1 OK created sql table model boston_crime.district_dim .................... [[32mCREATE TABLE (12.0 rows, 199.0 Bytes processed)[0m in 2.62s]
[0m22:04:35.657102 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.district_dim
[0m22:04:35.661120 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:04:35.663340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:35.664472 [debug] [MainThread]: Connection 'model.boston_crime_project.district_dim' was properly closed.
[0m22:04:35.665419 [info ] [MainThread]: 
[0m22:04:35.666678 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m22:04:35.667956 [debug] [MainThread]: Command end result
[0m22:04:35.688822 [info ] [MainThread]: 
[0m22:04:35.689860 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:04:35.690767 [info ] [MainThread]: 
[0m22:04:35.691702 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:04:35.692714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ad7d8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ad7d8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ad7d83d0>]}
[0m22:04:35.693865 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 22:06:12.384618 | 460134f9-5713-4447-8dab-6bf6fc7eac4b ==============================
[0m22:06:12.384618 [info ] [MainThread]: Running with dbt=1.4.9
[0m22:06:12.388214 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incident_fact'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:06:12.389446 [debug] [MainThread]: Tracking: tracking
[0m22:06:12.397863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79115b8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79115b8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79115b8e50>]}
[0m22:06:12.426723 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m22:06:12.588931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:06:12.590128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:06:12.601087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '460134f9-5713-4447-8dab-6bf6fc7eac4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793421c0d0>]}
[0m22:06:12.620990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '460134f9-5713-4447-8dab-6bf6fc7eac4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79342ee5b0>]}
[0m22:06:12.622436 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m22:06:12.624290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '460134f9-5713-4447-8dab-6bf6fc7eac4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79342ee5e0>]}
[0m22:06:12.627324 [info ] [MainThread]: 
[0m22:06:12.630632 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:06:12.632996 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m22:06:12.634090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:13.040179 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m22:06:13.042077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:13.361015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '460134f9-5713-4447-8dab-6bf6fc7eac4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793424c610>]}
[0m22:06:13.362640 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:06:13.364099 [info ] [MainThread]: 
[0m22:06:13.379386 [debug] [Thread-1  ]: Began running node model.boston_crime_project.incident_fact
[0m22:06:13.380790 [info ] [Thread-1  ]: 1 of 1 START sql incremental model boston_crime.incident_fact .................. [RUN]
[0m22:06:13.382559 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.incident_fact'
[0m22:06:13.383848 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.incident_fact
[0m22:06:13.388789 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.incident_fact"
[0m22:06:13.397070 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (compile): 2025-04-06 22:06:13.384925 => 2025-04-06 22:06:13.396948
[0m22:06:13.397972 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.incident_fact
[0m22:06:13.444549 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:06:13.795394 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.incident_fact"
[0m22:06:13.805219 [debug] [Thread-1  ]: On model.boston_crime_project.incident_fact: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.incident_fact"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact` as DBT_INTERNAL_DEST
        using (

WITH casted AS (
    SELECT DISTINCT 
        NULLIF(TRIM(INCIDENT_NUMBER), '') AS incident_number,
        CAST(OFFENSE_CODE AS INT64) AS offense_code,
        NULLIF(TRIM(OFFENSE_CODE_GROUP), '') AS offense_code_group,
        NULLIF(TRIM(OFFENSE_DESCRIPTION), '') AS offense_description,
        CASE 
            WHEN UPPER(TRIM(DISTRICT)) = 'OUTSIDE OF' THEN 'External'
            ELSE NULLIF(TRIM(DISTRICT), '')
        END AS district_code,
        NULLIF(TRIM(REPORTING_AREA), '') AS reporting_area,
        CASE
            WHEN UPPER(TRIM(SHOOTING)) IN ('Y','1') THEN 1
            WHEN UPPER(TRIM(SHOOTING)) IN ('N','0') THEN 0
            ELSE NULL
        END AS shooting,
        SAFE_CAST(TRIM(REPLACE(OCCURRED_ON_DATE, '+00', '')) AS DATETIME)
            AS occurred_on_datetime,
        CAST(YEAR AS INT64) AS year,
        CAST(MONTH AS INT64) AS month,
        NULLIF(TRIM(DAY_OF_WEEK), '') AS day_of_week,
        CAST(HOUR AS INT64) AS hour,
        NULLIF(TRIM(UCR_PART), '') AS ucr_part,
        NULLIF(TRIM(STREET), '') AS street,
        CAST(Lat AS FLOAT64) AS lat,
        CAST(Long AS FLOAT64) AS long
    FROM `galvanic-flame-447801-n5`.`boston_crime`.`crime_incidents_stg`
), deduped AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY incident_number, offense_code ORDER BY occurred_on_datetime DESC) AS row_num
    FROM casted
    WHERE incident_number IS NOT NULL
      AND offense_code IS NOT NULL
)


SELECT CONCAT(incident_number, offense_code)AS incident_offense_key,
        incident_number,
        offense_code,
        offense_code_group,
        offense_description,
        district_code,
        reporting_area,
        shooting,
        occurred_on_datetime,
        year,
        month,
        day_of_week,
        hour,
        street,
        lat,
        long
FROM deduped 
WHERE row_num = 1
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.incident_offense_key = DBT_INTERNAL_DEST.incident_offense_key
            )

    
    when matched then update set
        `incident_offense_key` = DBT_INTERNAL_SOURCE.`incident_offense_key`,`incident_number` = DBT_INTERNAL_SOURCE.`incident_number`,`offense_code` = DBT_INTERNAL_SOURCE.`offense_code`,`offense_code_group` = DBT_INTERNAL_SOURCE.`offense_code_group`,`offense_description` = DBT_INTERNAL_SOURCE.`offense_description`,`district_code` = DBT_INTERNAL_SOURCE.`district_code`,`reporting_area` = DBT_INTERNAL_SOURCE.`reporting_area`,`shooting` = DBT_INTERNAL_SOURCE.`shooting`,`occurred_on_datetime` = DBT_INTERNAL_SOURCE.`occurred_on_datetime`,`year` = DBT_INTERNAL_SOURCE.`year`,`month` = DBT_INTERNAL_SOURCE.`month`,`day_of_week` = DBT_INTERNAL_SOURCE.`day_of_week`,`hour` = DBT_INTERNAL_SOURCE.`hour`,`street` = DBT_INTERNAL_SOURCE.`street`,`lat` = DBT_INTERNAL_SOURCE.`lat`,`long` = DBT_INTERNAL_SOURCE.`long`
    

    when not matched then insert
        (`incident_offense_key`, `incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district_code`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `street`, `lat`, `long`)
    values
        (`incident_offense_key`, `incident_number`, `offense_code`, `offense_code_group`, `offense_description`, `district_code`, `reporting_area`, `shooting`, `occurred_on_datetime`, `year`, `month`, `day_of_week`, `hour`, `street`, `lat`, `long`)


    
[0m22:06:29.978525 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:b861a47b-f88f-41ec-8aa8-53e1b9989fbd&page=queryresults
[0m22:06:30.004631 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.incident_fact (execute): 2025-04-06 22:06:13.398789 => 2025-04-06 22:06:30.004513
[0m22:06:30.007036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '460134f9-5713-4447-8dab-6bf6fc7eac4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793415aee0>]}
[0m22:06:30.008622 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model boston_crime.incident_fact ............. [[32mMERGE (831.8k rows, 242.6 MB processed)[0m in 16.62s]
[0m22:06:30.012164 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.incident_fact
[0m22:06:30.016763 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:06:30.018771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:30.020398 [debug] [MainThread]: Connection 'model.boston_crime_project.incident_fact' was properly closed.
[0m22:06:30.021953 [info ] [MainThread]: 
[0m22:06:30.023490 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 17.39 seconds (17.39s).
[0m22:06:30.025340 [debug] [MainThread]: Command end result
[0m22:06:30.046629 [info ] [MainThread]: 
[0m22:06:30.048242 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:30.050210 [info ] [MainThread]: 
[0m22:06:30.052024 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:06:30.053904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7934170970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7934166f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793413c130>]}
[0m22:06:30.055611 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 22:06:36.573679 | 80a97e22-a367-45d5-b7a0-7a4683b2e4e6 ==============================
[0m22:06:36.573679 [info ] [MainThread]: Running with dbt=1.4.9
[0m22:06:36.576185 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['district_dim'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:06:36.577229 [debug] [MainThread]: Tracking: tracking
[0m22:06:36.583488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fababfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fababe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fababd60>]}
[0m22:06:36.607079 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m22:06:36.739551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:06:36.740712 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:06:36.748867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80a97e22-a367-45d5-b7a0-7a4683b2e4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79218100d0>]}
[0m22:06:36.768072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80a97e22-a367-45d5-b7a0-7a4683b2e4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79218d2640>]}
[0m22:06:36.769510 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m22:06:36.770719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80a97e22-a367-45d5-b7a0-7a4683b2e4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79218d2670>]}
[0m22:06:36.773021 [info ] [MainThread]: 
[0m22:06:36.776152 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:06:36.778596 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m22:06:36.779552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:37.145708 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m22:06:37.146854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:37.430835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80a97e22-a367-45d5-b7a0-7a4683b2e4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79218d26a0>]}
[0m22:06:37.433667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:06:37.435357 [info ] [MainThread]: 
[0m22:06:37.450680 [debug] [Thread-1  ]: Began running node model.boston_crime_project.district_dim
[0m22:06:37.452117 [info ] [Thread-1  ]: 1 of 1 START sql table model boston_crime.district_dim ......................... [RUN]
[0m22:06:37.453946 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.district_dim'
[0m22:06:37.455063 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.district_dim
[0m22:06:37.458690 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.district_dim"
[0m22:06:37.466711 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (compile): 2025-04-06 22:06:37.455918 => 2025-04-06 22:06:37.466587
[0m22:06:37.467709 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.district_dim
[0m22:06:37.485511 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:06:37.816990 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.district_dim"
[0m22:06:37.826438 [debug] [Thread-1  ]: On model.boston_crime_project.district_dim: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.district_dim"} */

  
    

    create or replace table `galvanic-flame-447801-n5`.`boston_crime`.`district_dim`
    
    
    OPTIONS()
    as (
      

SELECT
  NULLIF(TRIM(district), '') AS district_code,
  CASE WHEN NULLIF(TRIM(district), '') = 'A1' THEN 'Downtown'
       WHEN NULLIF(TRIM(district), '') = 'D4' THEN 'South End'
       ELSE NULLIF(TRIM(neighborhood), '') END AS neighborhood
FROM `galvanic-flame-447801-n5`.`boston_crime`.`police_districts_stg`
WHERE district IS NOT NULL
  AND neighborhood IS NOT NULL
    );
  
[0m22:06:39.909778 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:ffcf46a4-9fe7-4d46-946b-f4de1eef664e&page=queryresults
[0m22:06:39.937762 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.district_dim (execute): 2025-04-06 22:06:37.468488 => 2025-04-06 22:06:39.937659
[0m22:06:39.939564 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a97e22-a367-45d5-b7a0-7a4683b2e4e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7921744eb0>]}
[0m22:06:39.941045 [info ] [Thread-1  ]: 1 of 1 OK created sql table model boston_crime.district_dim .................... [[32mCREATE TABLE (12.0 rows, 199.0 Bytes processed)[0m in 2.49s]
[0m22:06:39.943949 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.district_dim
[0m22:06:39.947207 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:06:39.948483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:39.949414 [debug] [MainThread]: Connection 'model.boston_crime_project.district_dim' was properly closed.
[0m22:06:39.950231 [info ] [MainThread]: 
[0m22:06:39.951179 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m22:06:39.952221 [debug] [MainThread]: Command end result
[0m22:06:39.973556 [info ] [MainThread]: 
[0m22:06:39.974601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:39.975529 [info ] [MainThread]: 
[0m22:06:39.976545 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:06:39.978092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7929392250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7921723eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7921723be0>]}
[0m22:06:39.979207 [debug] [MainThread]: Flushing usage events


============================== 2025-04-06 22:06:45.982152 | 631e469c-27b4-42d7-8fa7-1ab0984133d2 ==============================
[0m22:06:45.982152 [info ] [MainThread]: Running with dbt=1.4.9
[0m22:06:45.984665 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['vw_incident_district'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:06:45.985480 [debug] [MainThread]: Tracking: tracking
[0m22:06:45.991817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940141cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940141cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940141ce80>]}
[0m22:06:46.014139 [debug] [MainThread]: checksum: 07ac7676dbf91b944d5fe41bac352fb2dda62b33015cbd1e52faa2a2c71f6d73, vars: {}, profile: None, target: None, version: 1.4.9
[0m22:06:46.123063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:06:46.124001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:06:46.133063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '631e469c-27b4-42d7-8fa7-1ab0984133d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94240820d0>]}
[0m22:06:46.153670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '631e469c-27b4-42d7-8fa7-1ab0984133d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9424148640>]}
[0m22:06:46.154744 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m22:06:46.155859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '631e469c-27b4-42d7-8fa7-1ab0984133d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9424148670>]}
[0m22:06:46.157710 [info ] [MainThread]: 
[0m22:06:46.161071 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:06:46.163903 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5'
[0m22:06:46.165366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:46.523332 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_galvanic-flame-447801-n5_boston_crime'
[0m22:06:46.527941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:46.831469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '631e469c-27b4-42d7-8fa7-1ab0984133d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94241486a0>]}
[0m22:06:46.833211 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:06:46.834898 [info ] [MainThread]: 
[0m22:06:46.854206 [debug] [Thread-1  ]: Began running node model.boston_crime_project.vw_incident_district
[0m22:06:46.855835 [info ] [Thread-1  ]: 1 of 1 START sql view model boston_crime.vw_incident_district .................. [RUN]
[0m22:06:46.857759 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.boston_crime_project.vw_incident_district'
[0m22:06:46.859454 [debug] [Thread-1  ]: Began compiling node model.boston_crime_project.vw_incident_district
[0m22:06:46.865402 [debug] [Thread-1  ]: Writing injected SQL for node "model.boston_crime_project.vw_incident_district"
[0m22:06:46.876937 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.vw_incident_district (compile): 2025-04-06 22:06:46.860733 => 2025-04-06 22:06:46.876749
[0m22:06:46.878237 [debug] [Thread-1  ]: Began executing node model.boston_crime_project.vw_incident_district
[0m22:06:46.921801 [debug] [Thread-1  ]: Writing runtime sql for node "model.boston_crime_project.vw_incident_district"
[0m22:06:46.932710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:06:46.969949 [debug] [Thread-1  ]: On model.boston_crime_project.vw_incident_district: /* {"app": "dbt", "dbt_version": "1.4.9", "profile_name": "my_boston_crime_profile", "target_name": "dev", "node_id": "model.boston_crime_project.vw_incident_district"} */


  create or replace view `galvanic-flame-447801-n5`.`boston_crime`.`vw_incident_district`
  OPTIONS()
  as 

SELECT
    f.incident_offense_key,
    f.incident_number,
    f.offense_description,    
    f.occurred_on_datetime,
    f.offense_code,
    f.offense_code_group,
    f.district_code,
    d.neighborhood,
    f.shooting,
    f.year,
    f.month,
    f.day_of_week,
    f.hour,
    f.street,
    f.lat,
    f.long
FROM `galvanic-flame-447801-n5`.`boston_crime`.`incident_fact` f
LEFT JOIN `galvanic-flame-447801-n5`.`boston_crime`.`district_dim` d
    ON f.district_code = d.district_code;


[0m22:06:47.577864 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=galvanic-flame-447801-n5&j=bq:us-east1:07e48b56-fe4a-4583-964a-1c26403f3093&page=queryresults
[0m22:06:47.598584 [debug] [Thread-1  ]: Timing info for model.boston_crime_project.vw_incident_district (execute): 2025-04-06 22:06:46.879930 => 2025-04-06 22:06:47.598458
[0m22:06:47.600780 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '631e469c-27b4-42d7-8fa7-1ab0984133d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9423fb7eb0>]}
[0m22:06:47.602481 [info ] [Thread-1  ]: 1 of 1 OK created sql view model boston_crime.vw_incident_district ............. [[32mCREATE VIEW (0 processed)[0m in 0.74s]
[0m22:06:47.605335 [debug] [Thread-1  ]: Finished running node model.boston_crime_project.vw_incident_district
[0m22:06:47.608952 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:06:47.611575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:47.612848 [debug] [MainThread]: Connection 'model.boston_crime_project.vw_incident_district' was properly closed.
[0m22:06:47.613903 [info ] [MainThread]: 
[0m22:06:47.615293 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m22:06:47.616773 [debug] [MainThread]: Command end result
[0m22:06:47.638039 [info ] [MainThread]: 
[0m22:06:47.639347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:47.640582 [info ] [MainThread]: 
[0m22:06:47.642331 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:06:47.643824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9423fc7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9423fc73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9423fc7430>]}
[0m22:06:47.645094 [debug] [MainThread]: Flushing usage events
